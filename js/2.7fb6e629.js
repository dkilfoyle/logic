(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"149f":function(e,t,n){"use strict";n("0481"),n("fb6a"),n("4069"),n("ddb0");var r=n("e0a5"),a=[],i=[],s=[],o=0,l=[];const c=(e,t)=>(n,r)=>(l.push({index:r,error:e,severity:t||"error"}),e),d=(e,t)=>t.from?t.from:t.back?e.index-t.back:e.index-t,u=(e,t,n)=>Object(r["u"])(r=>c(e,t)("",d(r,n))),p=Object(r["u"])(e=>o=e.index).map(e=>o),h=e=>t=>({type:e,value:t}),m=e=>e[e.length-1],b=Object(r["k"])(Object(r["p"])(/^./)),g=Object(r["r"])([Object(r["s"])("//"),Object(r["i"])(Object(r["c"])("\n")),r["n"]]),f=Object(r["r"])([Object(r["s"])("/*"),Object(r["i"])(Object(r["s"])("*/")),Object(r["s"])("*/")]),y=Object(r["l"])(Object(r["d"])([r["v"],g,f])).map(e=>e||""),v=e=>Object(r["b"])(y)(y)(e),O=Object(r["q"])(v(Object(r["c"])(","))),w=(Object(r["q"])(v(Object(r["c"])(";"))),Object(r["b"])(v(Object(r["c"])("(")))(v(Object(r["c"])(")")))),x=Object(r["b"])(v(Object(r["c"])("{")))(v(Object(r["c"])("}"))),C=Object(r["b"])(v(Object(r["c"])("[")))(v(Object(r["c"])("]"))),E=Object(r["p"])(/^[0-1]/).map(e=>parseInt(e)),j=["module","begin","input","output","wire","assign","endmodule","buffer","and","not","or","xor","nor","nand"],k=Object(r["e"])((function*(){const e=yield Object(r["g"])(v(Object(r["r"])([Object(r["p"])(/^[a-zA-Z_]/),Object(r["o"])(Object(r["p"])(/^[a-zA-Z0-9_]+/)).map(e=>null===e?"":e)])).map(e=>e.join("")));return e.isError&&(yield Object(r["j"])("Invalid ID")),j.some(t=>t==e.value)&&(yield Object(r["j"])("Identifier cannot be keyword")),e.value})),_=(Object(r["e"])((function*(){const e=yield r["f"];yield Object(r["s"])("'");const t=yield Object(r["s"])("b"),n=yield r["f"];return{type:"number",bits:e,base:t,value:n}})),Object(r["e"])((function*(){const e=yield k;return a.some(t=>t==e)||(yield Object(r["u"])(t=>c("Undefined variable","warning")("",t.index-e.length))),e}))),F=e=>t=>(console.log(e+":",t),t),T=Object(r["e"])((function*(){const e=yield k.errorMap(c("Invalid identifier"));return i.some(t=>t==e)||(yield Object(r["u"])(t=>c("Must be control variable","warning")("",t.index-e.length))),e})),S=Object(r["e"])((function*(){const e=yield _,t=yield Object(r["o"])(C(r["f"]));return{id:e,index:t}})),A=Object(r["e"])((function*(){const e=yield Object(r["r"])([Object(r["s"])("."),k]).map(e=>e[1]),t=yield w(S);return{param:e,mapped:t}})),q=Object(r["e"])((function*(){yield r["n"];const e=yield p,t=yield v(k).errorMap(e=>"no module"),n=yield v(k).errorMap(e=>"no id"),a=yield w(O(v(A)));yield Object(r["s"])(";");const i=s.find(e=>e==t);return i||(yield u("Module "+t+" not defined","warning",{from:e})),{type:"instance",module:t,id:n,params:a}})),I=Object(r["e"])((function*(){const e=yield Object(r["d"])([Object(r["s"])("and"),Object(r["s"])("nand"),Object(r["s"])("or"),Object(r["s"])("xor"),Object(r["s"])("nor"),Object(r["s"])("not"),Object(r["s"])("control"),Object(r["s"])("buffer")]),t=yield w(O(_));return yield v(Object(r["s"])(";")),{type:"gate",id:t[0],gate:e,params:t.slice(1)}})),P=Object(r["d"])([Object(r["c"])("&").map(e=>({type:"OP_AND",value:"and"})),Object(r["c"])("|").map(e=>({type:"OP_OR",value:"or"})),Object(r["c"])("^").map(e=>({type:"OP_XOR",value:"xor"})),Object(r["s"])("~&").map(e=>({type:"OP_NAND",value:"nand"})),Object(r["s"])("~|").map(e=>({type:"OP_NOR",value:"nor"}))]),N=Object(r["r"])([Object(r["o"])(Object(r["c"])("~")),_]).map(([e,t])=>({type:"VARIABLE",value:t,invert:null!=e})),L=e=>{const t=h("BRACKETED_EXPRESSION");return t(e.map(e=>Array.isArray(e)?L(e):e))},R=Object(r["e"])((function*(){const e={OPEN_BRACKET:0,OPERATOR_OR_CLOSING_BRACKET:1,ELEMENT_OR_OPENING_BRACKET:2,CLOSE_BRACKET:3};let t=e.ELEMENT_OR_OPENING_BRACKET;const n=[],a=[n];yield Object(r["c"])("(");while(1){const i=yield b;if(t===e.OPEN_BRACKET)yield Object(r["c"])("("),n.push([]),a.push(m(n)),yield r["n"],t=e.ELEMENT_OR_OPENING_BRACKET;else if(t===e.CLOSE_BRACKET){if(yield Object(r["c"])(")"),a.pop(),0===a.length)break;yield r["n"],t=e.OPERATOR_OR_CLOSING_BRACKET}else if(t===e.ELEMENT_OR_OPENING_BRACKET)")"===i&&(yield Object(r["j"])("Unexpected end of expression")),"("===i?t=e.OPEN_BRACKET:(m(a).push(yield N),yield r["n"],t=e.OPERATOR_OR_CLOSING_BRACKET);else{if(t!==e.OPERATOR_OR_CLOSING_BRACKET)throw new Error("Unknown state");if(")"===i){t=e.CLOSE_BRACKET;continue}m(a).push(yield P),yield r["n"],t=e.ELEMENT_OR_OPENING_BRACKET}}return L(n)})),M=Object(r["e"])((function*(){yield r["n"];const e={EXPECT_ELEMENT:0,EXPECT_OPERATOR:1},t=[];let n=e.EXPECT_ELEMENT;while(1)if(n===e.EXPECT_ELEMENT){const a=yield Object(r["d"])([R,N]);t.push(a),n=e.EXPECT_OPERATOR,yield r["n"]}else if(n===e.EXPECT_OPERATOR){const a=yield b;if(";"===a){yield Object(r["c"])(";"),yield r["n"];break}const i=yield P;t.push(i),n=e.EXPECT_ELEMENT,yield r["n"]}return h("ASSIGN_EXPRESSION")(t)})),D=Object(r["e"])((function*(){yield Object(r["s"])("assign ");const e=yield v(k).errorMap(c("Invalid assign identifier"));yield v(Object(r["s"])("="));const t=yield M.errorMap(c("Invalid expression"));return{type:"assign",id:e,value:t}})),B=Object(r["e"])((function*(){const e=yield C(Object(r["r"])([r["f"],Object(r["s"])(":"),r["f"]])).map(e=>[e[0],e[2]]);return e})),G=Object(r["r"])([v(k),Object(r["l"])(Object(r["t"])(Object(r["s"])(","))(v(k)))]).map(e=>e.flat()).errorMap(c("Invalid port identifier")),$=Object(r["e"])((function*(){const e=yield Object(r["d"])([v(Object(r["s"])("input")),v(Object(r["s"])("output"))]).errorMap(c("Invalid port type: must be 'input' or 'output'")),t=yield Object(r["o"])(B),n=yield G.errorMap(F("Invalid port identifier33333"));return n.map(n=>({type:e,dim:t,id:n}))})),W=Object(r["e"])((function*(){yield Object(r["s"])("wire ");const e=yield O(v(k).errorMap(c("Invalid wire identifier")));return yield v(Object(r["s"])(";")),e})),Q=Object(r["e"])((function*(){yield Object(r["s"])("module ").errorMap(c("Expecting 'module'"));const e=yield v(k).errorMap(c("Invalid module identifier")),t=yield Object(r["o"])(w(O($.errorMap(c("Invalid ports section")))).map(e=>e.flat()));yield v(Object(r["s"])(";"));var n=yield Object(r["o"])(v(W));n=n||[],a=[...t.map(e=>e.id),...n],i=[];const o=yield Object(r["l"])(Object(r["d"])([v(I),v(q),v(D)]));var l;o.forEach(e=>{"control"==e.gate&&i.push(e.id)}),"main"==e&&(l=yield X.errorMap(c("Invalid test block"))),yield v(Object(r["s"])("endmodule"));var d={type:"module",id:e,ports:t.flat(),wires:n,statements:o};return l&&(d.clock=l),s.push(e),d})),H=Object(r["e"])((function*(){const e=yield v(T);yield Object(r["s"])("=");const t=yield Object(r["r"])([v(E),Object(r["k"])(Object(r["a"])(E))]).map(e=>e[0]).errorMap(c("Expected 0 or 1"));return{id:e,value:parseInt(t,10)}})),K=Object(r["e"])((function*(){yield Object(r["s"])("#");const e=yield r["f"].errorMap(c("Invalid time"));yield r["n"];var t=yield Object(r["o"])(x(O(v(H))));return t=t||[],yield Object(r["s"])(";"),{time:parseInt(e,10),assignments:t}})),X=Object(r["e"])((function*(){yield v(Object(r["s"])("test begin"));const e=yield Object(r["l"])(v(K));return yield v(Object(r["s"])("end")),e})),U=e=>{l=[];const t=Object(r["r"])([Object(r["m"])(v(Q)),r["h"]]).map(e=>e[0]).run(e);return{parseState:t,lint:l}};t["a"]=U},"1f8d":function(e,t,n){},8041:function(e,t,n){"use strict";var r=n("cb9a"),a=n.n(r);a.a},"89e3":function(e,t,n){"use strict";var r=n("a14e"),a=n.n(r);a.a},"8b24":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"doc"},[n("div",{staticClass:"q-pa-md row items-start q-gutter-md justify-center"},[n("div",{staticClass:"col"},[n("q-tabs",{attrs:{"inline-label":""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[n("q-tab",{staticClass:"text-purple",attrs:{name:"code",label:"Code",icon:"functions"}}),n("q-tab",{attrs:{name:"gates",label:"Gates",icon:"toc",disable:!e.compiled.gates.length}}),n("q-tab",{attrs:{name:"trace",icon:"timeline",label:"Trace",disable:!e.compiled.gates.length}}),n("q-tab",{attrs:{name:"graph",label:"Schematic",icon:"electrical_services",disable:!e.compiled.gates.length}})],1),n("q-tab-panels",{attrs:{"keep-alive":"",dense:"",animated:"","transition-prev":"fade","transition-next":"fade"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[n("q-tab-panel",{key:"code",staticClass:"q-gutter-md",attrs:{name:"code"}},[n("div",{staticClass:"row"},[n("q-card",{staticClass:"col"},[n("q-toolbar",{staticClass:"bg-grey-4 filetabs"},[e._l(e.openFiles,(function(t){return n("q-tabs",{key:t,attrs:{shrink:"",stretch:"",dense:"","inline-label":"",align:"left","no-caps":"","active-color":"white","active-bg-color":"grey-9","indicator-color":"cyan"},model:{value:e.sourceTab,callback:function(t){e.sourceTab=t},expression:"sourceTab"}},[n("q-tab",{staticClass:"filetab",attrs:{name:t,label:t,dense:""}})],1)})),n("q-space"),n("div",{staticClass:"q-gutter-sm"},[e.sourceErrors(e.sourceTab)>0?n("q-badge",{attrs:{color:"red"}},[e._v(e._s(e.sourceErrors(e.sourceTab))+"\n                    "),n("q-icon",{staticClass:"q-ml-xs",attrs:{name:"warning",color:"white"}})],1):e._e(),n("q-btn-dropdown",{attrs:{dense:"",label:"Files"}},e._l(e.allFiles,(function(t){return n("q-list",{key:t},[n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(n){return e.onOpenFile(t)}}},[n("q-item-section",[n("q-item-label",[e._v(e._s(t))])],1)],1)],1)})),1),n("q-btn",{staticClass:"all-pointer-events z-top",attrs:{size:"xs",flat:"",round:"",icon:"close"},on:{click:e.closeFile}})],1)],2),e._l(e.openFiles,(function(t){return n("q-tab-panels",{key:t,attrs:{"keep-alive":""},model:{value:e.sourceTab,callback:function(t){e.sourceTab=t},expression:"sourceTab"}},[n("q-tab-panel",{key:t,staticClass:"q-pa-none",attrs:{name:t}},[n("editor",{on:{parsed:function(n){return e.onParsed(t,n)}},model:{value:e.source[t],callback:function(n){e.$set(e.source,t,n)},expression:"source[file]"}})],1)],1)}))],2)],1),n("div",{staticClass:"row"},[n("q-card",{staticClass:"col"},[n("q-card-section",[n("div",{staticClass:"row q-gutter-md q-pb-md"},[n("q-btn",{attrs:{color:"primary","icon-right":e.compileIcon,label:"Compile",disable:e.sourceErrors(e.sourceTab)>0},on:{click:e.compile}}),n("q-btn",{attrs:{color:"secondary","icon-right":"play_arrow",label:"Simulate",disable:"success"!=e.compiled.state},on:{click:e.simulate}}),n("q-space")],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showTerminal,expression:"showTerminal"}],staticClass:"row q-pa-sm",staticStyle:{"background-color":"black"}},[n("div",{staticClass:"col",staticStyle:{height:"20vh"},attrs:{id:"terminal"}})])])],1)],1)]),n("q-tab-panel",{key:"trace",attrs:{name:"trace"}},[n("trace",{attrs:{file:e.compiled.sourceFile,simulation:e.compiled.simulation,gates:e.compiled.gates,instances:e.compiled.instances}})],1),n("q-tab-panel",{key:"gates",attrs:{name:"gates"}},[n("gates",{attrs:{file:e.compiled.sourceFile,gates:e.compiled.gates,instances:e.compiled.instances}})],1),n("q-tab-panel",{key:"graph",attrs:{name:"graph"}},[n("graph",{ref:"graph",attrs:{file:e.compiled.sourceFile,gates:e.compiled.gates,instances:e.compiled.instances,simulation:e.compiled.simulation,simulationCounter:e.simulationCounter},on:{nodeClick:e.onNodeClick}})],1)],1)],1)])])},a=[],i=(n("fb6a"),n("a434"),n("4d90"),n("ddb0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("codemirror",{ref:"cmEditor",attrs:{value:e.value,options:e.cmOptions},on:{ready:e.onReady,input:e.onChange}})}),s=[],o=n("bad6"),l=o["a"],c=(n("a796"),n("2877")),d=Object(c["a"])(l,i,s,!1,null,null,null),u=d.exports,p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-pa-md q-gutter-md"},[n("q-card",[n("q-card-section",[n("div",{staticClass:"column"},[n("div",{staticClass:"q-gutter-y-sm"},[n("div",{staticClass:"row items-center q-gutter-x-md"},[n("q-btn",{attrs:{label:e.file},on:{click:e.redraw}}),n("q-checkbox",{attrs:{label:"Gate Labels"},model:{value:e.showNodeLabels,callback:function(t){e.showNodeLabels=t},expression:"showNodeLabels"}})],1),e.simulation.time.length>0?n("div",{staticClass:"row items-center q-gutter-x-md"},[n("div",[e._v("Simulation:")]),n("q-chip",[e._v("t = "+e._s(e.selectedTime)+" ")]),e.selectedNode?n("q-chip",[e._v(e._s(e.selectedNode))]):n("q-chip",[e._v("Click select a node and drag the trace timeline")])],1):e._e(),e.simulation&&e.selectedNode?n("div",{staticClass:"row items-center"},[n("dygraph",{attrs:{id:"timeLine",data:e.timeLineData},on:{clicked:e.timeLineClicked}})],1):e._e()])])]),n("q-separator"),n("q-card-section",[n("div",{ref:"graphParent",staticClass:"row",staticStyle:{width:"100%"}},[n("div",{ref:"graph"})])])],1)],1)},h=[],m=(n("e01a"),n("0481"),n("baa5"),n("4069"),n("30d1")),b=n.n(m),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"container",staticClass:"my-dygraphs"})},f=[],y=n("11f9");n("ff8b");window.Dygraph=y["a"],n("c951");var v={name:"dygraphs",props:{data:{type:Array,default:()=>[]},options:{type:Object},_updated:{type:Number,default:0}},data(){return{graph:null,needUpdate:!1,needOptionsUpdate:!1,defaultOptions:{plugins:[new window.Dygraph.Plugins.Crosshair({direction:"vertical"})],animatedZooms:!0,showLabelsOnHighlight:!1,zoomCallback:this.handleZoom,clickCallback:this.handleClick,fillGraph:!0,fillAlpha:.2,stepPlot:!0,showRangeSelector:!0,rangeSelectorHeight:20,axes:{x:{drawGrid:!1},y:{drawAxis:!1}}}}},computed:{graphOptions:{get(){return Object.assign({},this.defaultOptions,this.options)},set(){}}},mounted(){this.graph=new window.Dygraph(this.$refs.container,this.getData(),this.graphOptions),this.render(),this.$emit("created",this.graph)},watch:{_updated:function(){console.log("_udpated prop changed"),this.scheduleUpdate(!1)},data:{handler(){console.log("data changed"),this.scheduleUpdate(!1)},deep:!0}},methods:{render(){},getData(){if(!Array.isArray(this.data))return this.data;if(this.data.length<=0)return this.data;if(Array.isArray(this.data[0]))return this.data;let e=0;return this.data.map(t=>[e++,t])},scheduleUpdate(e){this.needUpdate=!0,this.needOptionsUpdate=e,this.$nextTick(()=>{this.update()})},update(){this.needUpdate&&(this.needUpdate=!1,this.needOptionsUpdate&&(this.graph.updateOptions(this.graphOptions),this.needOptionsUpdate=!1),this.graph.updateOptions({file:this.getData()}))},legendFormatter:function(e){if(null==e.x)return""+e.series.map((function(e){return e.dashHTML+" "+e.labelHTML})).join(" ");let t=this.graph.getLabels()[0]+": "+e.xHTML;return e.series.forEach((function(e){if(!e.isVisible)return;let n=e.labelHTML+": "+e.yHTML;e.isHighlighted&&(n="<b>"+n+"</b>"),t+="<br>"+e.dashHTML+" "+n})),t},handleClick:function(e,t,n){this.$emit("clicked",{x:t,points:n})},handleZoom:function(e,t,n){this.$emit("db-event",{type:"zoom",minDate:Math.floor(e),maxDate:Math.floor(t),yRanges:n})}}},O=v,w=(n("89e3"),Object(c["a"])(O,g,f,!1,null,null,null)),x=w.exports;b.a.registerEdge("can-running",{setState(e,t,n){const r=n.get("keyShape");if("running"===e)if(t){let e=0;r.animate(()=>{e++,e>9&&(e=0);const t={lineDash:[4,2,1,2],lineDashOffset:-e};return t},{repeat:!0,duration:3e3})}else r.stopAnimate(),r.attr("lineDash",null);else n.get("shapeFactory").getShape("cubic-horizontal").setState(e,t,n)}},"cubic-horizontal");var C={props:["gates","instances","file","simulation","simulationCounter"],components:{dygraph:x},data(){return{graph:null,layout:"dagre",showNodeLabels:!1,linkDistance:150,selectedTime:0,selectedNode:null,timeLineOptions:{}}},watch:{simulationCounter:function(){this.selectedTime=this.simulation.maxTime},simulation:function(e){console.log("watchsim",e)},graphData:function(e){console.log("graphData Watch"),this.graph.changeData(e),this.showLogicStates(),this.selectedTime=this.simulation.maxTime},graphConfig:function(e){console.log("graphConfig Watch"),this.graph.updateLayout(e.layout)}},methods:{setSelectedTime(e){this.selectedTime=e},timeLineClicked:function(e){this.selectedTime=e.x,this.gates.forEach(e=>e.state=this.simulation.gates[e.id][this.selectedTime]),this.showLogicStates()},redraw:function(){this.graph.data(this.graphData),this.graph.render(),this.showLogicStates()},showLogicStates:function(){this.gates.forEach(e=>{const t=this.graph.findById(e.id);t.setState("logic",1==e.state?"on":"off"),t.getEdges().forEach(t=>t.setState("logic",1==e.state?"on":"off"))})}},computed:{timeLineData:function(){if(this.simulation.gates[this.selectedNode]){let e=[];for(let t=0;t<this.simulation.time.length;t++)e.push([this.simulation.time[t],this.simulation.gates[this.selectedNode][t]]);return e}return[]},graphConfig:function(){return"force"==this.layout?{layout:{type:"force",preventOverlap:!0,linkDistance:this.linkDistance}}:"dagre"==this.layout?{layout:{type:"dagre",rankdir:"LR",align:"DL",controlPoints:!0,nodesepFunc:()=>1,ranksepFunc:()=>1}}:{layout:{type:"force"}}},graphData:function(){if(this.gates){const e={nodes:this.gates.map(e=>{const t={id:e.id,label:this.showNodeLabels?e.id.substring(e.id.lastIndexOf(".")+1):null,description:e.id,icon:{show:!0,img:e.logic+".svg"},comboId:e.instance};return"buffer"!=e.logic&&"control"!=e.logic&&"not"!=e.logic||(t.anchorPoints=[[0,.5],[1,.5]],t.sourceAnchor=0,t.targetAnchor=1),t}),edges:this.gates.map(e=>e.inputs?e.inputs.map(t=>({source:t,target:e.id})):null).flat().filter(e=>e),combos:this.instances.map(e=>{const t=e.id.substring(0,e.id.lastIndexOf(".")),n=e.id.split(".").length-1,r={id:e.id,label:e.id.substring(e.id.lastIndexOf(".")+1),style:{fillOpacity:.3*n}};return""!=t&&(r.parentId=t),r})};return console.log("graphData Computed: ",e),e}return{}}},mounted(){this.selectedTime=this.simulation.maxTime||0,this.graph=new b.a.Graph({container:this.$refs.graph,height:700,width:this.$refs.graphParent.clientWidth,groupByTypes:!1,fitView:!0,fitViewPadding:40,layout:this.graphConfig.layout,animate:!0,animateCfg:{duration:500,easing:"easeLinear"},defaultNode:{type:"circle",size:30,linkPoints:{top:!1,bottom:!1,left:!1,right:!1,fill:"#fff",size:5},anchorPoints:[[0,.25],[0,.75],[1,.5]],sourceAnchor:2,targetAnchor:0,labelCfg:{style:{fill:"#1890ff",fontSize:6},position:"bottom"},style:{opacity:1,lineWidth:1,stroke:"#999"}},defaultEdge:{type:"can-running",style:{endArrow:{path:b.a.Arrow.triangle(4,4,0),d:0,fill:"#999"},startArrow:!1,opacity:1,lineWidth:1,stroke:"#999"}},defaultCombo:{type:"rect",anchorPoints:[[0,.25],[0,.75],[0,.5],[1,.5]],sourceAnchor:3,targetAnchor:0},nodeStateStyles:{"hover:connected":{opacity:1},"hover:notconnected":{opacity:.6},"hover:nothovering":{opacity:1},selected:{},"logic:on":{stroke:"orangered",fill:"lightsalmon"},"logic:off":{stroke:"royalblue",fill:"skyblue"}},edgeStateStyles:{"hover:connected":{opacity:1,lineWidth:2},"hover:notconnected":{opacity:.2},"hover:nothovering":{opacity:1},"logic:on":{stroke:"orangered",endArrow:{path:b.a.Arrow.triangle(4,4,0),d:5,fill:"orangered"}},"logic:off":{stroke:"royalblue",endArrow:{fill:"royalblue"}}},modes:{default:["drag-node","drag-canvas","drag-combo","collapse-expand-combo","zoom-canvas",{type:"tooltip",formatText:function(e){const t=e.description;return t},offset:30}]}}),this.graph.on("node:click",e=>{if(!this.simulation.time)return;const t=e.item,n=t.get("id");if(n!=this.selectedNode)return void(this.selectedNode=n);this.$emit("nodeClick",this.selectedNode,this.selectedTime),this.selectedTime="User";const r=t.hasState("selected");t.setState("selected",!r)}),this.graph.on("node:mouseenter",e=>{var t=this.graph.getEdges().forEach(e=>e.setState("hover","notconnected"));t=this.graph.getNodes().forEach(e=>e.setState("hover","notconnected"));const n=e.item;t=n.getEdges(),t.forEach(e=>{e.setState("running",!0),e.setState("hover","connected")}),n.setState("hover","connected")}),this.graph.on("node:mouseleave",e=>{var t=this.graph.getEdges().forEach(e=>e.setState("hover","nothovering"));t=this.graph.getNodes().forEach(e=>e.setState("hover","nothovering"));const n=e.item;t=n.getEdges(),t.forEach(e=>e.setState("running",!1)),n.setState("hover","nothovering")}),this.set,this.redraw()}},E=C,j=(n("eb33"),n("f09f")),k=n("a370"),_=n("b047"),F=n("9c40"),T=n("8f8e"),S=n("eb85"),A=n("eebe"),q=n.n(A),I=Object(c["a"])(E,p,h,!1,null,null,null),P=I.exports;q()(I,"components",{QCard:j["a"],QCardSection:k["a"],QChip:_["a"],QBtn:F["a"],QCheckbox:T["a"],QSeparator:S["a"]});var N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-pa-sm q-gutter-sm"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-3"},[n("div",{staticClass:"text-subtitle2"},[e._v(e._s(e.file))]),n("q-tree",{attrs:{nodes:e.instanceTree,"node-key":"id","selected-color":"primary",selected:e.instanceID,"default-expand-all":""},on:{"update:selected":function(t){e.instanceID=t}}})],1),n("div",{staticClass:"col-9 q-gutter-md"},[n("div",{staticClass:"row"},[n("q-radio",{attrs:{val:"all",label:"All"},model:{value:e.showWhichGates,callback:function(t){e.showWhichGates=t},expression:"showWhichGates"}}),n("q-radio",{attrs:{val:"inputs",label:"Inputs"},model:{value:e.showWhichGates,callback:function(t){e.showWhichGates=t},expression:"showWhichGates"}}),n("q-radio",{attrs:{val:"outputs",label:"Outputs"},model:{value:e.showWhichGates,callback:function(t){e.showWhichGates=t},expression:"showWhichGates"}})],1),e.selectedInstance?n("div",[n("q-scroll-area",{staticStyle:{height:"70vh"}},[e._l(e.selectedGates,(function(t){return n("div",{key:t.globalid,staticClass:"row q-pb-sm"},[n("div",{staticClass:"col-10"},[n("dygraph",{ref:"traces",refInFor:!0,attrs:{data:e.tracedata(t.globalid),options:e.traceOptions(t.globalid)}})],1),n("div",{staticClass:"col-2"},[n("div",{staticClass:"text-caption"},[e._v(e._s(t.instanceid))])])])})),n("div",{staticClass:"row q-pt-lg"},[n("div",{staticClass:"col-10"},[n("dygraph",{ref:"clock",attrs:{data:e.clock,options:{showRangeSelector:!0,rangeSelectorHeight:80,axes:{y:{axisLabelWidth:5}}}}})],1),n("div",{staticClass:"col-2"},[n("div",{staticClass:"text-caption"},[e._v("Clock")])])])],2)],1):e._e()])])])},L=[],R={data:function(){return{instanceID:"main",showWhichGates:"all"}},computed:{selectedInstance:function(){return this.getInstance(this.instanceID)},instanceTree:function(){const e=t=>{const n=this.instances.find(e=>e.id==t);return{label:n.id.slice(n.id.lastIndexOf(".")+1),id:n.id,children:n.instances.map(t=>e(t))}};return[e("main")]},selectedGates:function(){var e=this.selectedInstance;switch(this.showWhichGates){case"all":return[...e.inputs,...e.wires,...e.outputs];case"wires":return[...e.wires];case"outputs":return[...e.outputs];case"inputs":return[...e.inputs]}return[]},allInstanceGates:function(){var e=this.selectedInstance;return[...e.inputs,...e.wires,...e.outputs]}},methods:{getGate:function(e){return this.gates.find(t=>t.id==e)},getInstance:function(e){return this.instances.find(t=>t.id==e)}}};window.Dygraph=y["a"],n("932a");var M={props:["simulation","gates","instances","file"],mixins:[R],components:{dygraph:x},data(){return{}},computed:{clock:function(){return this.simulation.clock.map((e,t)=>[t,e])}},watch:{selectedGates:function(e){this.$nextTick(()=>{this.syncTraces()})}},methods:{syncTraces(){if(0==this.$refs.traces.length)return;let e=this.$refs.traces.map(e=>e.graph);e.push(this.$refs.clock.graph),Dygraph.synchronize(e)},tracedata:function(e){let t=[];for(let n=0;n<this.simulation.time.length;n++)t.push([this.simulation.time[n],this.simulation.gates[e][n]]);return t},traceOptions:function(e){return{height:50,showRangeSelector:!1,xrangePad:5,axes:{x:{drawAxis:!1,drawGrid:!1},y:{drawAxis:!0,drawGrid:!1,axisLabelWidth:5,axisLineColor:"white",axisLabelFormatter:()=>null}},series:{Y1:{color:this.traceColor(e)}}}},traceColor:function(e){return this.selectedInstance.outputs.some(t=>t.globalid==e)?"rgb(255,99,132)":this.selectedInstance.inputs.some(t=>t.globalid==e)?"steelblue":"darkgrey"}},mounted(){this.syncTraces()}},D=M,B=n("7f41"),G=n("3786"),$=n("4983"),W=Object(c["a"])(D,N,L,!1,null,null,null),Q=W.exports;q()(W,"components",{QTree:B["a"],QRadio:G["a"],QScrollArea:$["a"]});var H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-pa-md q-gutter-md"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-3"},[n("div",{staticClass:"text-subtitle2"},[e._v(e._s(e.file))]),n("q-tree",{attrs:{nodes:e.instanceTree,"node-key":"id","selected-color":"primary",selected:e.instanceID,"default-expand-all":""},on:{"update:selected":function(t){e.instanceID=t}}})],1),n("div",{staticClass:"col-9 q-gutter-md"},[n("div",{staticClass:"row"},[n("q-radio",{attrs:{val:"all",label:"All"},model:{value:e.showWhichGates,callback:function(t){e.showWhichGates=t},expression:"showWhichGates"}}),n("q-radio",{attrs:{val:"outputs",label:"Outputs"},model:{value:e.showWhichGates,callback:function(t){e.showWhichGates=t},expression:"showWhichGates"}})],1),n("q-scroll-area",{staticStyle:{height:"70vh"}},[n("div",{staticClass:"row q-pa-md"},[n("q-markup-table",{staticClass:"full-width"},[n("thead",{staticClass:"bg-teal"},[n("tr",{staticClass:"text-white"},[n("th",{staticClass:"text-left"},[e._v("GlobalID")]),n("th",{staticClass:"text-left"},[e._v("Function")]),n("th",{staticClass:"text-left"},[e._v("Inputs")]),n("th",{staticClass:"text-right"},[e._v("State")])])]),n("tbody",e._l(e.selectedGates,(function(t){return n("tr",{key:t.globalid},[n("td",[e._v(e._s(t.globalid))]),n("td",[e._v(e._s(e.getGate(t.globalid).logic))]),n("td",[e._v(e._s(e.getGate(t.globalid).inputs.join(", ")))]),n("td",{staticClass:"text-right"},[e._v(e._s(e.getGate(t.globalid).state))])])})),0)])],1)])],1)])])},K=[],X=(n("1c16"),{props:["gates","instances","file"],mixins:[R],data(){return{showWhichGates:"all"}}}),U=X,z=n("2bb1"),V=Object(c["a"])(U,H,K,!1,null,null,null),Z=V.exports;q()(V,"components",{QTree:B["a"],QRadio:G["a"],QScrollArea:$["a"],QMarkupTable:z["a"]});var Y,J,ee,te=n("149f");n("07ac");const ne=(e,t)=>{""!==e&&(e+=".");const n=Y[t.module],r=t.params.reduce((r,a)=>(r[a.param]={globalid:e+a.mapped.id,type:"port",moduleid:a.param,instanceid:e+t.id+"."+a.param,porttype:n.ports.find(e=>e.id==a.param).type},r),{}),a=n=>(r[n]={globalid:e+t.id+"."+n,instanceid:e+t.id+"."+n,moduleid:n,type:"wire"},r[n].globalid);n.wires.forEach(a);const i=n=>(ee.push({id:r[n.id].instanceid,logic:n.gate,inputs:n.params.map(e=>r[e].globalid),instance:e+t.id,state:0}),r[n.id].moduleid);n.statements.filter(e=>"gate"==e.type).forEach(i);const s=(e,t)=>{let n;if("BRACKETED_EXPRESSION"==e.type||"ASSIGN_EXPRESSION"==e.type){let o=e.value;for(let e=1;e<o.length;e+=2){let l=e==o.length-2?t:t+"op"+e;r[l]||a(l),n=i({id:l,gate:o[e].value,params:[1==e?s(o[e-1],t+"op"+(e-1)):n,s(o[e+1],t+"op"+(e+1))]})}return n}if("VARIABLE"==e.type){if(n=e.value,e.invert){if(!r["not"+n]){a("not"+n);i({id:"not"+n,gate:"not",params:[n]})}return"not"+n}return n}throw new Error("vlgWalker shouldn't be here. Node is not VARIABLE or EXPRESSION")};n.statements.filter(e=>"assign"==e.type).forEach(e=>s(e.value,e.id));var o={id:e+t.id,inputs:Object.values(r).filter(e=>"port"==e.type&&"input"==e.porttype),outputs:Object.values(r).filter(e=>"port"==e.type&&"output"==e.porttype),wires:Object.values(r).filter(e=>"wire"==e.type),instances:[]};return n.statements.filter(e=>"instance"==e.type).forEach(n=>{var r=ne(e+t.id,n);r.outputs.forEach(e=>{ee.find(t=>t.id==e.globalid).inputs.push(e.instanceid)}),o.instances.push(r.id)}),J.push(o),o},re=e=>{Y=e.reduce((e,t)=>"module"==!t.type?(console.log("top level of ast should be modules only"),e):(e[t.id]=t,e),{}),ee=[],J=[];const t={params:Y.main.ports.map(e=>({param:e.id,mapped:{id:"main."+e.id}})),id:"main",module:"main"};return ne("",t),{instances:J,gates:ee}};var ae=re,ie=(n("abb2"),n("fcf3")),se=n("47d0"),oe="// One bit full adder\r\n\r\nmodule SingleStage (\r\n  input a,\r\n  input b,\r\n  input cin,\r\n  output s,\r\n  output cout );\r\n\r\n  wire w1, w2, w3;\r\n\r\n  and( w1, a, b );\r\n  and( w2, a, cin );\r\n  and( w3, b, cin );\r\n  or( cout, w1, w2, w3 );\r\n\r\n  xor( s, a, b, cin );\r\n\r\nendmodule\r\n\r\nmodule main(\r\n  output sum,\r\n  output cout);\r\n\r\n  wire a, b, cin;\r\n\r\n  control(a);\r\n  control(b);\r\n  control(cin);\r\n\r\n  SingleStage uut(\r\n\t\t.a(a),\r\n\t\t.b(b),\r\n\t\t.cin(cin),\r\n\t\t.s(sum),\r\n\t\t.cout(cout)\r\n  );\r\n\r\n  buffer(sum);\r\n  buffer(cout);\r\n\r\n\ttest begin\r\n\t\t#0  {a=0, b=0, cin=0};\r\n    #2  {a=0, b=0, cin=0};\r\n    #4  {a=0, b=0, cin=1};\r\n    #6  {a=0, b=1, cin=0};\r\n    #8  {a=0, b=1, cin=1};\r\n    #10 {a=1, b=0, cin=0};\r\n    #12 {a=1, b=0, cin=1};\r\n    #14 {a=1, b=1, cin=0};\r\n    #16 {a=1, b=1, cin=1};\r\n\tend\r\nendmodule",le="// D Flip Flop\r\n\r\nmodule DFF (\r\n\tinput clk,\r\n\tinput dIn,\r\n\toutput q);\r\n\r\n\twire not_d_in, d_nand_a, d_nand_c, q_;\r\n\r\n\tnot( not_d_in, dIn );\r\n\tnand( d_nand_a, dIn, clk );\r\n\tnand( q, d_nand_a, q_ );\r\n\tnand( d_nand_c, not_d_in, clk );\r\n  nand( q_, d_nand_c, q);\r\nendmodule\r\n\r\nmodule DFFE (\r\n  input clk,\r\n  input dIn,\r\n  input dEnable,\r\n  output q);\r\n\r\n  wire gatedClk, dInB;\r\n  and( gatedClk, clk, dEnable );\r\n  buffer( dInB, dIn) ;\r\n\r\n  DFF dff( .clk(gatedClk), .dIn(dInB), .q(q));\r\n\r\n  buffer(q);\r\nendmodule\r\n\r\nmodule main(output q);\r\n\r\n  wire A, E, clock;\r\n\r\n  control(A);\r\n  control(E);\r\n  control(clock);\r\n\r\n  DFFE dffe(.clk(clock), .dIn(A), .dEnable(E), .q(q));\r\n\r\n  buffer(q);\r\n\r\n  test begin\r\n    #0  { E=1 };\r\n    #1  { A=1, E=0 };\r\n    #7  { E=1 };\r\n    #9  { A=0, E=0 };\r\n    #12;\r\n  end\r\nendmodule",ce="// template to show basic syntax\r\n\r\nmodule MyModule (\r\n  input a, b,\r\n  output X, Y );\r\n\r\n  // gate format: logicFn(id, input1, input2)\r\n  and( X, a, b );\r\n  or(  Y, a, b );\r\n\r\n  // alternative bitwise format\r\n  // assign X = a & b;\r\nendmodule\r\n\r\nmodule main(\r\n  output o1, o2);\r\n\r\n  // wires act as local variables/gates\r\n  wire user1, user2, cin;\r\n\r\n  // control is an external button/sensor\r\n  // control state is set in the testbench\r\n  control(user1);\r\n  control(user2);\r\n\r\n  // declare foo as an instance (copy) of MyModule\r\n  // map the input/output parameters of MyModule to the calling namespace\r\n  // .moduleParameter(callingNamespaceVariable)\r\n  MyModule foo(\r\n\t\t.a(user1),\r\n\t\t.b(user2),\r\n\t\t.x(o1),\r\n\t\t.y(o2)\r\n  );\r\n\r\n  // foo needs something to wire it's outputs to in main\r\n  buffer(o1);\r\n  buffer(o2);\r\n\r\n  // main module should have a testbench to set control states\r\n  // format: #time {controlVar=val,...}\r\n  test begin\r\n    #0  {user1=0, user2=0};\r\n    #2  {user1=0, user2=1};\r\n    #4  {user1=1, user2=0};\r\n    #6  {user1=1, user2=1};\r\n  end\r\nendmodule",de="/* 2 to 4 one hot decoder\r\na b | F3 F2 F1 F0\r\n0 0 |  0  0  0  1 \r\n0 1 |  0  0  1  0\r\n1 0 |  0  1  0  0\r\n1 1 |  1  0  0  0\r\n*/\r\n\r\n// using bitwise assigns\r\nmodule OneHotDecoderBitwise (\r\n  input a, b,\r\n  output F3, F2, F1, F0);\r\n\r\n  assign F0 = ~a & ~b;\r\n  assign F1 = ~a & b;\r\n  assign F2 = a & ~b;\r\n  assign F3 = a & b;\r\nendmodule\r\n\r\n// using standard gate statements\r\nmodule OneHotDecoder (\r\n  input a, b,\r\n  output F3, F2, F1, F0);\r\n\r\n  wire nota, notb;\r\n  not(nota, a);\r\n  not(notb, b);\r\n\r\n  and(F0, nota, notb);\r\n  and(F1, nota, b);\r\n  and(F2, a, notb);\r\n  and(F3, a, b);\r\nendmodule\r\n\r\nmodule main(\r\n  output F3, F2, F1, F0);\r\n\r\n  wire a, b;\r\n  control(a);\r\n  control(b);\r\n\r\n  // OneHotDecoder ohd(\r\n  OneHotDecoderBitwise ohd(\r\n\t\t.a(a),\r\n\t\t.b(b),\r\n\t\t.F3(F3),\r\n\t\t.F2(F2),\r\n\t\t.F1(F1),\r\n\t\t.F0(F0)\r\n  );\r\n\r\n  buffer(F3);\r\n  buffer(F2);\r\n  buffer(F1);\r\n  buffer(F0);\r\n\r\n  test begin\r\n\t\t#0  {a=0, b=0};\r\n    #2  {a=0, b=1};\r\n    #4  {a=1, b=0};\r\n    #6  {a=1, b=1};\r\n    #8;\r\n\tend\r\nendmodule",ue="/* 7 segment display decoder\r\n  a\r\nf   b\r\n  g\r\ne   c\r\n  d\r\n\r\nA B C | Fa Fb Fc Fd Fe Ff Fg\r\n0 0 0 |  1  1  1  1  1  1  0 \r\n0 0 1 |  0  1  1  0  0  0  0\r\n0 1 0 |  1  1  0  1  1  0  1\r\n0 1 1 |  1  1  1  1  0  0  1\r\n1 0 0 |  0  1  1  0  0  1  1 \r\n1 0 1 |  1  0  1  1  0  1  1\r\n1 1 0 |  1  0  1  1  1  1  1\r\n1 1 1 |  1  1  1  0  0  0  0\r\n*/\r\n\r\n// using standard gate statements\r\nmodule SevenSeg(\r\n  input A, B, C,\r\n  output Fa, Fb, Fc, Fd, Fe, Ff, Fg);\r\n\r\n  assign Fa = (~A & ~C) | B        | (A & C);\r\n  assign Fb = (~B & ~C) | ~A       | (B & C);\r\n  assign Fc = A         | ~B       | C;\r\n  assign Fd = (~A & ~C) | (~A & B) | (B & ~C) | (A & ~B & C);\r\n  assign Fe = (~A & ~C) | (B & ~C);\r\n  assign Ff = (~B & ~C) | (A & ~C) | (A & ~B);\r\n  assign Fg = (~A & B)  | (A & ~C) | (A & ~B);\r\nendmodule\r\n\r\nmodule main(\r\n  output Fa, Fb, Fc, Fd, Fe, Ff, Fg);\r\n\r\n  wire a, b, c;\r\n\r\n  control(a);\r\n  control(b);\r\n  control(c);\r\n\r\n  SevenSeg ss(\r\n\t\t.A(a),\r\n\t\t.B(b),\r\n\t\t.C(c),\r\n    .Fa(Fa),\r\n    .Fb(Fb),\r\n    .Fc(Fc),\r\n    .Fd(Fd),\r\n    .Fe(Fe),\r\n    .Ff(Ff),\r\n    .Fg(Fg)\r\n  );\r\n\r\n  buffer(Fa);\r\n  buffer(Fb);\r\n  buffer(Fc);\r\n  buffer(Fd);\r\n  buffer(Fe);\r\n  buffer(Ff);\r\n  buffer(Fg);\r\n\r\n  test begin\r\n    #00 {a=0, b=0, c=0}; // should get 1 1 1 1 1 1 0\r\n    #02 {a=0, b=0, c=1}; // should get 0 1 1 0 0 0 0\r\n    #04 {a=0, b=1, c=0}; // should get 1 1 0 1 1 0 1\r\n    #06 {a=0, b=1, c=1}; // should get 1 1 1 1 0 0 1\r\n    #08 {a=1, b=0, c=0}; // should get 0 1 1 0 0 1 1 \r\n    #10 {a=1, b=0, c=1}; // should get 1 0 1 1 0 1 1\r\n    #12 {a=1, b=1, c=0}; // should get 1 0 1 1 1 1 1\r\n    #14 {a=1, b=1, c=1}; // should get 1 1 1 0 0 0 0\r\n    #16;\r\n\tend\r\nendmodule",pe="/* 2 to 1 Multiplexer\r\nSel selects which input to pass to output\r\nsel a b | F\r\n 0  0 0 | 0 \r\n 0  0 1 | 0 \r\n 0  1 0 | 1 \r\n 0  1 1 | 1 \r\n----------- \r\n 1  0 0 | 0\r\n 1  0 1 | 1\r\n 1  1 0 | 0\r\n 1  1 1 | 1\r\n */\r\n\r\nmodule Mux2_1 (\r\n\tinput sel,\r\n\tinput a, b,\r\n\toutput F);\r\n\r\n\tassign F = (~sel & a) | (sel & b);\r\nendmodule\r\n\r\nmodule main(output F);\r\n  wire a, b, sel;\r\n\r\n  control(a);\r\n  control(b);\r\n  control(sel);\r\n\r\n  Mux2_1 mux(.a(a), .b(b), .sel(sel), .F(F));\r\n  buffer(F);\r\n\r\n  test begin\r\n    #01 {sel=0, a=0, b=0}; // expect 0 \r\n    #02 {sel=0, a=0, b=1}; // expect 0 \r\n    #03 {sel=0, a=1, b=0}; // expect 1 \r\n    #04 {sel=0, a=1, b=1}; // expect 1 \r\n    #05 {sel=1, a=0, b=0}; // expect 0\r\n    #06 {sel=1, a=0, b=1}; // expect 1\r\n    #07 {sel=1, a=1, b=0}; // expect 0\r\n    #08 {sel=1, a=1, b=1}; // expect 1\r\n    #09;\r\n  end\r\nendmodule",he='/* 1 to 2 DeMultiplexer\r\nSel selects which output to send the input to\r\nsel a | Y Z\r\n 0  0 | 0 0 \r\n 0  1 | 1 0 \r\n 1  0 | 0 0 \r\n 1  1 | 0 1 \r\n */\r\n\r\nmodule DeMux (\r\n\tinput sel,\r\n\tinput a,\r\n\toutput Y, Z);\r\n\r\n\tassign Y = ~sel & a;\r\n  assign Z = sel & a;\r\nendmodule\r\n\r\nmodule main(output Y, Z);\r\n  wire clock, sel;\r\n\r\n  control(sel);\r\n  control(clock); // "clock" is controlled automatically during test\r\n\r\n  DeMux demux(.a(clock), .sel(sel), .Y(Y), .Z(Z));\r\n  buffer(Y);\r\n  buffer(Z);\r\n\r\n  test begin\r\n    #01 {sel=0};  \r\n    #010 {sel=1}; \r\n    #020;\r\n  end\r\nendmodule',me=n("2b0e");const be=n("53f4");let ge={enabled:!0,level:2};const fe=new be.Instance(ge),ye=e=>{const t=e.join(", ");return t.length<21?t:t.slice(0,40)+"..."},ve=(e,t)=>e.reduce((e,n)=>(e[n[t]]=n,e),{}),Oe=e=>1&~e,we={not:e=>1&~e,buffer:e=>e,and2:(e,t)=>e&&t,nand2:(e,t)=>Oe(e&&t),or2:(e,t)=>e||t,nor2:(e,t)=>Oe(e||t),xor2:(e,t)=>e^t,xnor2:(e,t)=>Oe(e^t),and3:(e,t,n)=>e&&t&&n,nand3:(e,t,n)=>Oe(e&&t&&n),or3:(e,t,n)=>e||t||n,nor3:(e,t,n)=>Oe(e||t||n),xor3:(e,t,n)=>e^t^n,xnor3:(e,t,n)=>Oe(e^t^n)},xe=(e,t)=>{const n=e=>{let n=e.logic;if(1==e.inputs.length){if("not"!=n&&"buffer"!=n)return void console.log("Gate evaluation error - 1 input only valid for not and buffer gates");const r=t[e.inputs[0]];if(!r)throw console.log(e.inputs[0]),new Error("component not found");return void(e.state="x"===r?"x":we[n](r.state))}const r=t[e.inputs[0]],a=t[e.inputs[1]];if(2!=e.inputs.length)if(3!=e.inputs.length);else{const i=t[e.inputs[2]];e.state="x"===r||"x"===a||"x"===i?"x":we[n+"3"](r.state,a.state,i.state)}else e.state="x"===r||"x"===a?"x":we[n+"2"](r.state,a.state)};e.forEach(e=>{if("control"!==e.logic)return n(e)})};var Ce={name:"PageIndex",components:{Editor:u,Graph:P,Gates:Z,Trace:Q},data(){return{EVALS_PER_STEP:5,terminal:{},showTerminal:!0,fitAddon:{},simulationCounter:0,compiled:{state:"uncompiled",sourceFile:"",parseTree:{lint:[]},gates:[],instances:[],simulation:{gates:{},time:[],maxTime:0}},tab:"code",layout:"dagre",source:{BitAdder:oe,DFF:le,Scratch:ce,OneHotDecoder:de,SevenSeg:ue,Mux2_1:pe,DeMux:he},sourceTab:"Mux2_1",openFiles:["Scratch","OneHotDecoder","SevenSeg","Mux2_1","DeMux"],errors:{}}},computed:{allFiles:function(){return Object.keys(this.source)},compileIcon:function(){return"success"==this.compiled.state?"check_circle":"error"==this.compiled.state?"error_outline":"replay"}},methods:{closeFile:function(){var e=this.openFiles.findIndex(e=>e==this.sourceTab);this.openFiles.splice(e,1),this.sourceTab=this.openFiles[e%this.openFiles.length]},sourceErrors:function(e){return this.errors[e]},onParsed(e,t){me["a"].set(this.errors,e,t)},onOpenFile(e){this.openFiles.some(t=>t==e)||this.openFiles.push(e),this.sourceTab=e},termWriteln(e){this.terminal.write(e+"\n\r"),this.terminal.scrollToBottom()},compile(){this.showTerminal=!0,this.compiled.sourceFile=this.sourceTab,this.termWriteln(fe.bold.green("• Compiling: ")+fe.yellow(this.sourceTab));const e=Object(te["a"])(this.source[this.sourceTab]).parseState;if(console.log("Parse: ",e),e.isError)return this.compiled.state="error",void this.termWriteln(fe.red("└── Parser error: ")+e.error);this.compiled.state="success",this.compiled.parseTree=e.result,this.termWriteln(fe.green(`├── Parsed ${this.compiled.parseTree.length} modules: ${fe.white(this.compiled.parseTree.map(e=>e.id).join(", "))}`));const t=ae(this.compiled.parseTree);console.log("Walk: ",t),this.compiled.instances=[...t.instances],this.compiled.gates=[...t.gates],this.termWriteln(fe.green(`├── Generated ${this.compiled.instances.length} instances: ${fe.white(ye(this.compiled.instances.map(e=>e.id)))}`)),this.termWriteln(fe.green(`└── Generated ${this.compiled.gates.length} gates: ${fe.white(ye(this.compiled.gates.map(e=>e.id)))}`)),this.termWriteln(fe.green.inverse(" DONE ")+"  Compiled successfully")},onNodeClick(e,t){const n=this.compiled.gates.find(t=>t.id==e);if(n&&"control"==n.logic){n.state=1&~n.state;var r=ve(this.compiled.gates,"id");for(let e=0;e<this.EVALS_PER_STEP;e++)xe(this.compiled.gates,r);this.$refs.graph.showLogicStates()}},simulate(){this.showTerminal=!0,this.termWriteln(fe.bold.cyan("• Simulating: ")+fe.yellow(this.compiled.sourceFile)),this.$set(this.compiled.simulation,"gates",{}),this.compiled.gates.forEach(e=>{e.state=0,this.$set(this.compiled.simulation.gates,e.id,[])}),this.$set(this.compiled.simulation,"clock",[]);var e=ve(this.compiled.gates,"id"),t=ve(this.compiled.instances,"id"),n=ve(this.compiled.parseTree,"id");const r=n.main.clock.reduce((e,t)=>Math.max(t.time,e),0);this.$set(this.compiled.simulation,"time",[]),e["main.clock"]&&(e["main.clock"].state=0);for(let a=0;a<=r;a++){this.compiled.simulation.time.push(a),n.main.clock.forEach(t=>{t.time==a&&t.assignments.forEach(t=>{"control"==e["main."+t.id].logic&&(e["main."+t.id].state=t.value)})}),e["main.clock"]&&(e["main.clock"].state=1&~e["main.clock"].state);for(let t=0;t<this.EVALS_PER_STEP;t++)xe(this.compiled.gates,e);this.compiled.gates.forEach(t=>{this.compiled.simulation.gates[t.id].push(e[t.id].state)}),this.compiled.simulation.clock.push(a%2),n.main.clock.forEach((n,r,i)=>{if(n.time!=a)return;const s=r==i.length-1?"└":"├";this.termWriteln(fe.cyan(`${s}── Time ${a.toString().padStart(3,"0")} :`)+ye(n.assignments.map(e=>e.id+"="+e.value))+fe.cyan(" => ")+ye(t.main.outputs.map(t=>t.moduleid+"="+e[t.globalid].state)))})}this.termWriteln(fe.cyan.inverse(" DONE ")+"  Simulated successfully"),this.compiled.simulation.maxTime=this.compiled.simulation.time[this.compiled.simulation.time.length-1],this.simulationCounter=this.simulationCounter+1}},mounted(){this.terminal=new ie["Terminal"]({rows:40}),this.fitAddon=new se["FitAddon"],this.terminal.loadAddon(this.fitAddon),this.terminal.open(document.getElementById("terminal")),this.fitAddon.fit()}},Ee=Ce,je=(n("8041"),n("9989")),ke=n("429b"),_e=n("7460"),Fe=n("adad"),Te=n("823b"),Se=n("65c6"),Ae=n("2c91"),qe=n("58a81"),Ie=n("0016"),Pe=n("f20b"),Ne=n("1c1c"),Le=n("66e5"),Re=n("4074"),Me=n("0170"),De=n("7f67"),Be=Object(c["a"])(Ee,r,a,!1,null,null,null);t["default"]=Be.exports;q()(Be,"components",{QPage:je["a"],QTabs:ke["a"],QTab:_e["a"],QTabPanels:Fe["a"],QTabPanel:Te["a"],QCard:j["a"],QToolbar:Se["a"],QSpace:Ae["a"],QBadge:qe["a"],QIcon:Ie["a"],QBtnDropdown:Pe["a"],QList:Ne["a"],QItem:Le["a"],QItemSection:Re["a"],QItemLabel:Me["a"],QBtn:F["a"],QSeparator:S["a"],QCardSection:k["a"]}),q()(Be,"directives",{ClosePopup:De["a"]})},"9aff":function(e,t,n){"use strict";n("c975"),n("fb6a"),n("4e82");var r=n("56b3"),a=n.n(r);n("149f"),n("5068");String.prototype.regexIndexOf=function(e,t){var n=this.substring(t||0).search(e);return n>=0?n+(t||0):n},a.a.defineSimpleMode("vlg",{meta:{lineComment:"//"},start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"string"},{regex:/(?:module|begin)/,token:"def",indent:!0},{regex:/(?:input|output|endmodule|end)\b/,token:"def"},{regex:/(?:not|and|or|xor|nand|control|buffer)\b/,token:"keyword"},{regex:/(?:wire|test|assign)\b/,token:"variable-2"},{regex:/true|false|null|undefined/,token:"atom"},{regex:/0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i,token:"number"},{regex:/\/\/.*/,token:"comment"},{regex:/\/(?:[^\\]|\\.)*?\//,token:"variable-3"},{regex:/\/\*/,token:"comment",next:"comment"},{regex:/[-+\/*=<>!]+/,token:"operator"},{regex:/[\{\[\(]/,indent:!0},{regex:/[\}\]\)]/,dedent:!0},{regex:/[a-zA-Z$][\w$]*/,token:"variable"}],comment:[{regex:/.*?\*\//,token:"comment",next:"start"},{regex:/.*/,token:"comment"}]}),a.a.registerHelper("fold","vlg",(function(e,t){function n(e,t){var n=t&&t.match(/^(begin|module)+/);return n}var r=e.getLine(t.line),i=n(t.line,r);if(i){var s=e.lastLine(),o=t.line,l=e.getLine(o+1);while(o<s){if(n(o+1,l))break;++o,l=e.getLine(o+1)}return{from:a.a.Pos(t.line,r.length),to:a.a.Pos(o,e.getLine(o).length)}}}));var i={start:["nand(","and(","or(","xor(","nor(","not(","control","input","output","wire","assign"],none:["module"]};a.a.registerHelper("hint","dictionaryHint",(function(e){var t=e.getCursor(),n=e.getLine(t.line),r=t.ch,s=r,o=e.getTokenAt(e.getCursor()).state;while(s<n.length&&/[\w$]/.test(n.charAt(s)))++s;while(r&&/[\w$]/.test(n.charAt(r-1)))--r;var l=r!==s&&n.slice(r,s),c=new RegExp("^"+l,"i");return{list:(l?i[o.state].filter((function(e){return e.match(c)})):i[o.state]).sort(),from:a.a.Pos(t.line,r),to:a.a.Pos(t.line,s)}})),a.a.commands.autocomplete=function(e){a.a.showHint(e,a.a.hint.dictionaryHint)},a.a.commands.snippet=function(e){a.a.showHint(e,o)};const s=[{text:"module Name (\n   input A,B,C,\n   output X,Y);\n   // statements here\nendmodule",displayText:"module definition"},{text:"ModuleName instanceName(\n  .p1(m1), // .instanceParamater(LocalVar)\n  .p2(m2),\n  .p3(m3)\n);",displayText:"instance declaration"},{text:"and(gateID, input1, input2);",displayText:"gate declaration"},{text:"assign ID = (A & B);",displayText:"assign declaration"}];function o(e){const t=e.getCursor(),n=e.getTokenAt(t),r=n.start,i=t.ch,o=t.line,l=n.string,c=s.filter((function(e){return e.text.indexOf(l)>=0}));return{list:c.length?c:s,from:a.a.Pos(o,r),to:a.a.Pos(o,i)}}},a12c:function(e,t,n){},a14e:function(e,t,n){},a796:function(e,t,n){"use strict";var r=n("1f8d"),a=n.n(r);a.a},bad6:function(e,t,n){"use strict";(function(e){var r=n("8f94"),a=n("56b3"),i=n.n(a),s=(n("76ae"),n("10b2"),n("8c33"),n("8822"),n("0dd0"),n("9b74"),n("f6b6"),n("7289"),n("4895"),n("cbc8"),n("697e"),n("149f"));n("9aff"),n("a7be"),n("7a7a");e.CodeMirror=i.a;var o=n("5068");t["a"]={components:{codemirror:r["codemirror"]},props:["value"],data(){return{parser:s["a"],cmOptions:{viewportMargin:1/0,tabSize:2,indentUnit:2,mode:"vlg",theme:"monokai",lineNumbers:!0,line:!0,extraKeys:{"Ctrl-Space":"autocomplete","Shift-Ctrl-Space":"snippet","Ctrl-/":"toggleComment","Ctrl-Q":function(e){e.foldCode(e.getCursor())}},lint:{selfContain:!0,getAnnotations:this.vlgValidator},autoCloseBrackets:!0,matchBrackets:!0,gutters:["CodeMirror-lint-markers","CodeMirror-linenumbers","CodeMirror-foldgutter"],foldGutter:!0}}},methods:{vlgValidator:function(e,t,n){if(0==e.length)return[];var r=[];const a=this.parser(e);var s=o(e,{origin:0});const l=(t,n,a)=>{var o=s.fromIndex(n),l=s.fromIndex(Math.max(e.regexIndexOf(/[\s\(\)\[\]\{\},=]/,n),n));r.push({message:t,severity:a,from:i.a.Pos(o.line,o.col),to:i.a.Pos(l.line,l.col)})};return a.lint.forEach(e=>l(e.error,e.index,e.severity)),a.parseState.isError&&0==a.lint.length&&l(a.parseState.error,a.parseState.index),this.$emit("parsed",r),r},onReady(e){},onChange(e){this.$emit("input",e)}},computed:{codemirror(){return this.$refs.cmEditor.codemirror}},mounted(){}}}).call(this,n("c8ba"))},cb9a:function(e,t,n){},eb33:function(e,t,n){"use strict";var r=n("a12c"),a=n.n(r);a.a}}]);