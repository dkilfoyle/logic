(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"1f8d":function(e,t,n){},"22ff":function(e,t,n){"use strict";var s=n("5a1d"),r=n.n(s);r.a},"5a1d":function(e,t,n){},8041:function(e,t,n){"use strict";var s=n("cb9a"),r=n.n(s);r.a},"89e3":function(e,t,n){"use strict";var s=n("a14e"),r=n.n(s);r.a},"8b24":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"doc"},[n("div",{staticClass:"q-pa-md row items-start q-gutter-md justify-center"},[n("div",{staticClass:"col"},[n("q-tabs",{attrs:{"inline-label":""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[n("q-tab",{staticClass:"text-purple",attrs:{name:"code",label:"Code",icon:"functions"}}),n("q-tab",{attrs:{name:"gates",label:"Gates",icon:"toc",disable:!e.compiled.gates.length}}),n("q-tab",{attrs:{name:"trace",icon:"timeline",label:"Trace",disable:!e.compiled.gates.length}}),n("q-tab",{attrs:{name:"graph",label:"Graph",icon:"electrical_services",disable:!e.compiled.gates.length}}),n("q-tab",{attrs:{name:"schematic",label:"Schematic",icon:"electrical_services",disable:!e.compiled.gates.length}})],1),n("q-tab-panels",{attrs:{"keep-alive":"",dense:"",animated:"","transition-prev":"fade","transition-next":"fade"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[n("q-tab-panel",{key:"code",staticClass:"q-gutter-md",attrs:{name:"code"}},[n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("q-toolbar",{staticClass:"bg-grey-4 filetabs"},[e._l(e.openFiles,(function(t){return n("q-tabs",{key:t,attrs:{shrink:"",stretch:"",dense:"","inline-label":"",align:"left","no-caps":"","active-color":"white","active-bg-color":"grey-9","indicator-color":"cyan"},model:{value:e.sourceTab,callback:function(t){e.sourceTab=t},expression:"sourceTab"}},[n("q-tab",{staticClass:"filetab",attrs:{name:t,label:t,dense:""}})],1)})),n("q-space"),n("div",{staticClass:"q-gutter-sm"},[e.sourceErrors(e.sourceTab)>0?n("q-badge",{attrs:{color:"red"}},[e._v(e._s(e.sourceErrors(e.sourceTab))+"\n                    "),n("q-icon",{staticClass:"q-ml-xs",attrs:{name:"warning",color:"white"}})],1):e._e(),n("q-btn-dropdown",{attrs:{dense:"",label:"Files"}},e._l(e.allFiles,(function(t){return n("q-list",{key:t},[n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(n){return e.onOpenFile(t)}}},[n("q-item-section",[n("q-item-label",[e._v(e._s(t))])],1)],1)],1)})),1),n("q-btn",{staticClass:"all-pointer-events z-top",attrs:{size:"xs",flat:"",round:"",icon:"close"},on:{click:e.closeFile}})],1)],2),e._l(e.openFiles,(function(t){return n("q-tab-panels",{key:t,attrs:{"keep-alive":""},model:{value:e.sourceTab,callback:function(t){e.sourceTab=t},expression:"sourceTab"}},[n("q-tab-panel",{key:t,staticClass:"q-pa-none",attrs:{name:t}},[n("editor",{on:{parsed:function(n){return e.onParsed(t,n)}},model:{value:e.source[t],callback:function(n){e.$set(e.source,t,n)},expression:"source[file]"}})],1)],1)}))],2)]),n("div",{staticClass:"row"},[n("q-card",{staticClass:"col",attrs:{bordered:""}},[n("q-card-section",[n("div",{staticClass:"row q-gutter-md q-pb-md"},[n("q-btn",{attrs:{color:"primary","icon-right":e.compileIcon,label:"Compile",disable:e.sourceErrors(e.sourceTab)>0},on:{click:e.compile}}),n("q-btn",{attrs:{color:"secondary","icon-right":"play_arrow",label:"Simulate",disable:"success"!=e.compiled.state},on:{click:e.simulate}}),n("q-space")],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showTerminal,expression:"showTerminal"}],staticClass:"row q-pa-sm",staticStyle:{"background-color":"black"}},[n("div",{staticClass:"col",staticStyle:{height:"20vh"},attrs:{id:"terminal"}})])])],1)],1)]),n("q-tab-panel",{key:"trace",attrs:{name:"trace"}},[n("trace",{attrs:{file:e.compiled.sourceFile,simulation:e.compiled.simulation,gates:e.compiled.gates,instances:e.compiled.instances}})],1),n("q-tab-panel",{key:"gates",attrs:{name:"gates"}},[n("gates",{attrs:{file:e.compiled.sourceFile,gates:e.compiled.gates,instances:e.compiled.instances}})],1),n("q-tab-panel",{key:"graph",attrs:{name:"graph"}},[n("graph",{ref:"graph",attrs:{file:e.compiled.sourceFile,gates:e.compiled.gates,instances:e.compiled.instances,simulation:e.compiled.simulation},on:{nodeClick:e.onNodeClick}})],1),n("q-tab-panel",{key:"schematic",attrs:{name:"schematic"}},[n("schematic",{ref:"schematic",attrs:{compiled:e.compiled}})],1)],1)],1)])])},r=[],a=(n("fb6a"),n("a434"),n("4d90"),n("ddb0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("codemirror",{ref:"cmEditor",attrs:{value:e.value,options:e.cmOptions},on:{ready:e.onReady,input:e.onChange}})}),i=[],o=n("bad6"),c=o["a"],l=(n("a796"),n("2877")),d=Object(l["a"])(c,a,i,!1,null,null,null),u=d.exports,p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-pa-md q-gutter-md"},[n("q-card",{attrs:{flat:"",bordered:""}},[n("q-card-section",[n("div",{staticClass:"column"},[n("div",{staticClass:"q-gutter-y-sm"},[n("div",{staticClass:"row items-center q-gutter-x-md"},[n("q-btn",{attrs:{label:e.file},on:{click:e.redraw}}),n("q-checkbox",{attrs:{label:"Gate Labels"},model:{value:e.showNodeLabels,callback:function(t){e.showNodeLabels=t},expression:"showNodeLabels"}})],1),e.simulation.time.length>0?n("div",{staticClass:"row items-center q-gutter-x-md"},[n("div",[e._v("Simulation:")]),n("q-chip",[e._v("t = "+e._s(e.selectedTime)+" ")]),e.selectedNode?n("q-chip",[e._v(e._s(e.selectedNode))]):n("q-chip",[e._v("Click select a node and drag the trace timeline")])],1):e._e(),e.simulation&&e.selectedNode?n("div",{staticClass:"row items-center"},[n("dygraph",{attrs:{id:"timeLine",data:e.timeLineData},on:{clicked:e.timeLineClicked}})],1):e._e()])])]),n("q-separator"),n("q-card-section",[n("div",{ref:"graphParent",staticClass:"row",staticStyle:{width:"100%"}},[n("div",{ref:"graph"})])])],1)],1)},h=[],m=(n("e01a"),n("0481"),n("baa5"),n("4069"),n("30d1")),g=n.n(m),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"container",staticClass:"my-dygraphs"})},f=[],v=n("11f9");n("ff8b");window.Dygraph=v["a"],n("c951");var y={name:"dygraphs",props:{data:{type:Array,default:()=>[]},options:{type:Object},_updated:{type:Number,default:0}},data(){return{graph:null,needUpdate:!1,needOptionsUpdate:!1,defaultOptions:{plugins:[new window.Dygraph.Plugins.Crosshair({direction:"vertical"})],animatedZooms:!0,showLabelsOnHighlight:!1,zoomCallback:this.handleZoom,clickCallback:this.handleClick,fillGraph:!0,fillAlpha:.2,stepPlot:!0,showRangeSelector:!0,rangeSelectorHeight:20,axes:{x:{drawGrid:!1},y:{drawAxis:!1}}}}},computed:{graphOptions:{get(){return Object.assign({},this.defaultOptions,this.options)},set(){}}},mounted(){this.graph=new window.Dygraph(this.$refs.container,this.getData(),this.graphOptions),this.render(),this.$emit("created",this.graph)},watch:{_updated:function(){console.log("_udpated prop changed"),this.scheduleUpdate(!1)},data:{handler(){console.log("data changed"),this.scheduleUpdate(!1)},deep:!0}},methods:{render(){},getData(){if(!Array.isArray(this.data))return this.data;if(this.data.length<=0)return this.data;if(Array.isArray(this.data[0]))return this.data;let e=0;return this.data.map(t=>[e++,t])},scheduleUpdate(e){this.needUpdate=!0,this.needOptionsUpdate=e,this.$nextTick(()=>{this.update()})},update(){this.needUpdate&&(this.needUpdate=!1,this.needOptionsUpdate&&(this.graph.updateOptions(this.graphOptions),this.needOptionsUpdate=!1),this.graph.updateOptions({file:this.getData()}))},legendFormatter:function(e){if(null==e.x)return""+e.series.map((function(e){return e.dashHTML+" "+e.labelHTML})).join(" ");let t=this.graph.getLabels()[0]+": "+e.xHTML;return e.series.forEach((function(e){if(!e.isVisible)return;let n=e.labelHTML+": "+e.yHTML;e.isHighlighted&&(n="<b>"+n+"</b>"),t+="<br>"+e.dashHTML+" "+n})),t},handleClick:function(e,t,n){this.$emit("clicked",{x:t,points:n})},handleZoom:function(e,t,n){this.$emit("db-event",{type:"zoom",minDate:Math.floor(e),maxDate:Math.floor(t),yRanges:n})}}},O=y,w=(n("89e3"),Object(l["a"])(O,b,f,!1,null,null,null)),_=w.exports;g.a.registerEdge("can-running",{setState(e,t,n){const s=n.get("keyShape");if("running"===e)if(t){let e=0;s.animate(()=>{e++,e>9&&(e=0);const t={lineDash:[4,2,1,2],lineDashOffset:-e};return t},{repeat:!0,duration:3e3})}else s.stopAnimate(),s.attr("lineDash",null);else n.get("shapeFactory").getShape("cubic-horizontal").setState(e,t,n)}},"cubic-horizontal");var x={props:["gates","instances","file","simulation","simulationCounter"],components:{dygraph:_},data(){return{graph:null,layout:"dagre",showNodeLabels:!1,linkDistance:150,selectedTime:0,selectedNode:null,timeLineOptions:{}}},watch:{simulationCounter:function(){this.selectedTime=this.simulation.maxTime},simulation:function(e){console.log("watchsim",e)},graphData:function(e){console.log("graphData Watch"),this.graph.changeData(e),this.showLogicStates(),this.selectedTime=this.simulation.maxTime},graphConfig:function(e){console.log("graphConfig Watch"),this.graph.updateLayout(e.layout)}},methods:{setSelectedTime(e){this.selectedTime=e},timeLineClicked:function(e){this.selectedTime=e.x,this.gates.forEach(e=>e.state=this.simulation.gates[e.id][this.selectedTime]),this.showLogicStates()},redraw:function(){this.graph.data(this.graphData),this.graph.render(),this.showLogicStates()},showLogicStates:function(){this.gates.forEach(e=>{const t=this.graph.findById(e.id);t.setState("logic",1==e.state?"on":"off"),t.getEdges().forEach(t=>t.setState("logic",1==e.state?"on":"off"))})}},computed:{timeLineData:function(){if(this.simulation.gates[this.selectedNode]){let e=[];for(let t=0;t<this.simulation.time.length;t++)e.push([this.simulation.time[t],this.simulation.gates[this.selectedNode][t]]);return e}return[]},graphConfig:function(){return"force"==this.layout?{layout:{type:"force",preventOverlap:!0,linkDistance:this.linkDistance}}:"dagre"==this.layout?{layout:{type:"dagre",rankdir:"LR",align:"DL",controlPoints:!0,nodesepFunc:()=>1,ranksepFunc:()=>1}}:{layout:{type:"force"}}},graphData:function(){if(this.gates){const e={nodes:this.gates.map(e=>{const t={id:e.id,label:this.showNodeLabels?e.id.substring(e.id.lastIndexOf(".")+1):null,description:e.id,icon:{show:!0,img:e.logic+".svg"},comboId:e.instance};return"buffer"!=e.logic&&"control"!=e.logic&&"not"!=e.logic||(t.anchorPoints=[[0,.5],[1,.5]],t.sourceAnchor=0,t.targetAnchor=1),t}),edges:this.gates.map(e=>e.inputs?e.inputs.map(t=>({source:t,target:e.id})):null).flat().filter(e=>e),combos:this.instances.map(e=>{const t=e.id.substring(0,e.id.lastIndexOf(".")),n=e.id.split(".").length-1,s={id:e.id,label:e.id.substring(e.id.lastIndexOf(".")+1),style:{fillOpacity:.3*n}};return""!=t&&(s.parentId=t),s})};return console.log("graphData Computed: ",e),e}return{}}},mounted(){this.selectedTime=this.simulation.maxTime||0,this.graph=new g.a.Graph({container:this.$refs.graph,height:700,width:this.$refs.graphParent.clientWidth,groupByTypes:!1,fitView:!0,fitViewPadding:40,layout:this.graphConfig.layout,animate:!0,animateCfg:{duration:500,easing:"easeLinear"},defaultNode:{type:"circle",size:30,linkPoints:{top:!1,bottom:!1,left:!1,right:!1,fill:"#fff",size:5},anchorPoints:[[0,.25],[0,.75],[1,.5]],sourceAnchor:2,targetAnchor:0,labelCfg:{style:{fill:"#1890ff",fontSize:6},position:"bottom"},style:{opacity:1,lineWidth:1,stroke:"#999"}},defaultEdge:{type:"can-running",style:{endArrow:{path:g.a.Arrow.triangle(4,4,0),d:0,fill:"#999"},startArrow:!1,opacity:1,lineWidth:1,stroke:"#999"}},defaultCombo:{type:"rect",anchorPoints:[[0,.25],[0,.75],[0,.5],[1,.5]],sourceAnchor:3,targetAnchor:0},nodeStateStyles:{"hover:connected":{opacity:1},"hover:notconnected":{opacity:.6},"hover:nothovering":{opacity:1},selected:{},"logic:on":{stroke:"orangered",fill:"lightsalmon"},"logic:off":{stroke:"royalblue",fill:"skyblue"}},edgeStateStyles:{"hover:connected":{opacity:1,lineWidth:2},"hover:notconnected":{opacity:.2},"hover:nothovering":{opacity:1},"logic:on":{stroke:"orangered",endArrow:{path:g.a.Arrow.triangle(4,4,0),d:5,fill:"orangered"}},"logic:off":{stroke:"royalblue",endArrow:{fill:"royalblue"}}},modes:{default:["drag-node","drag-canvas","drag-combo","collapse-expand-combo","zoom-canvas",{type:"tooltip",formatText:function(e){const t=e.description;return t},offset:30}]}}),this.graph.on("node:click",e=>{if(!this.simulation.time)return;const t=e.item,n=t.get("id");if(n!=this.selectedNode)return void(this.selectedNode=n);this.$emit("nodeClick",this.selectedNode,this.selectedTime),this.selectedTime="User";const s=t.hasState("selected");t.setState("selected",!s)}),this.graph.on("node:mouseenter",e=>{var t=this.graph.getEdges().forEach(e=>e.setState("hover","notconnected"));t=this.graph.getNodes().forEach(e=>e.setState("hover","notconnected"));const n=e.item;t=n.getEdges(),t.forEach(e=>{e.setState("running",!0),e.setState("hover","connected")}),n.setState("hover","connected")}),this.graph.on("node:mouseleave",e=>{var t=this.graph.getEdges().forEach(e=>e.setState("hover","nothovering"));t=this.graph.getNodes().forEach(e=>e.setState("hover","nothovering"));const n=e.item;t=n.getEdges(),t.forEach(e=>e.setState("running",!1)),n.setState("hover","nothovering")}),this.set,this.redraw()}},E=x,C=(n("eb33"),n("f09f")),k=n("a370"),F=n("b047"),j=n("9c40"),I=n("8f8e"),S=n("eb85"),T=n("eebe"),q=n.n(T),A=Object(l["a"])(E,p,h,!1,null,null,null),D=A.exports;q()(A,"components",{QCard:C["a"],QCardSection:k["a"],QChip:F["a"],QBtn:j["a"],QCheckbox:I["a"],QSeparator:S["a"]});var P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-pa-sm q-gutter-sm"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-3"},[n("div",{staticClass:"text-subtitle2"},[e._v(e._s(e.file))]),n("q-tree",{attrs:{nodes:e.instanceTree,"node-key":"id","selected-color":"primary",selected:e.instanceID,"default-expand-all":""},on:{"update:selected":function(t){e.instanceID=t}}})],1),n("div",{staticClass:"col-9 q-gutter-md"},[n("div",{staticClass:"row"},[n("q-radio",{attrs:{val:"all",label:"All"},model:{value:e.showWhichGates,callback:function(t){e.showWhichGates=t},expression:"showWhichGates"}}),n("q-radio",{attrs:{val:"inputs",label:"Inputs"},model:{value:e.showWhichGates,callback:function(t){e.showWhichGates=t},expression:"showWhichGates"}}),n("q-radio",{attrs:{val:"outputs",label:"Outputs"},model:{value:e.showWhichGates,callback:function(t){e.showWhichGates=t},expression:"showWhichGates"}}),n("q-radio",{attrs:{val:"ports",label:"Ports"},model:{value:e.showWhichGates,callback:function(t){e.showWhichGates=t},expression:"showWhichGates"}})],1),e.selectedInstance?n("div",[n("q-scroll-area",{staticStyle:{height:"70vh"}},[e._l(e.selectedGates,(function(t){return n("div",{key:t,staticClass:"row q-pb-sm"},[n("div",{staticClass:"col-10"},[n("dygraph",{ref:"traces",refInFor:!0,attrs:{data:e.tracedata(t),options:e.traceOptions(t)}})],1),n("div",{staticClass:"col-2"},[n("div",{staticClass:"text-caption"},[e._v(e._s(e.getLocalId(t)))])])])})),n("div",{staticClass:"row q-pt-lg"},[n("div",{staticClass:"col-10"},[n("dygraph",{ref:"clock",attrs:{data:e.clock,options:{showRangeSelector:!0,rangeSelectorHeight:80,axes:{y:{axisLabelWidth:5}}}}})],1),n("div",{staticClass:"col-2"},[n("div",{staticClass:"text-caption"},[e._v("Clock")])])])],2)],1):e._e()])])])},R=[],N=(n("c975"),{data:function(){return{instanceID:"main",showWhichGates:"all"}},watch:{instances:function(){this.instanceID="main",this.showWhichGates="all"}},computed:{selectedInstance:function(){return this.getInstance(this.instanceID)},instanceTree:function(){const e=t=>{const n=this.instances.find(e=>e.id==t);return{label:n.id.slice(n.id.lastIndexOf("_")+1),id:n.id,children:n.instances.map(t=>e(t))}};return[e("main")]},selectedGates:function(){switch(this.showWhichGates){case"all":return this.allInstanceGates;case"wires":return[...this.getGates(this.instanceID)];case"outputs":return[...this.getOutputs(this.instanceID)];case"inputs":return[...this.getInputs(this.instanceID)];case"ports":return[...this.getInputs(this.instanceID),...this.getOutputs(this.instanceID)]}return[]},allInstanceGates:function(){return[...new Set([...this.getInputs(this.instanceID),...this.getGates(this.instanceID),...this.getOutputs(this.instanceID)])]}},methods:{getInputs:function(e){return this.getInstance(e).inputs},getOutputs:function(e){return this.getInstance(e).outputs.map(e=>e.substr(0,e.indexOf("-out")))},getGates:function(e){return this.getInstance(e).gates.filter(e=>"gate"==this.getGate(e).type)},isInput:function(e,t){return this.getInputs(e).some(e=>e==t)||"control"==this.getGate(t).logic},isOutput:function(e,t){return this.getOutputs(e).some(e=>e==t)||"response"==this.getGate(t).logic},getGate:function(e){return this.gates.find(t=>t.id==e)},getInstance:function(e){return this.instances.find(t=>t.id==e)},getLocalId:function(e){return e.substr(e.lastIndexOf("_")+1)}}});window.Dygraph=v["a"],n("932a");var M={props:["simulation","gates","instances","file"],mixins:[N],components:{dygraph:_},data(){return{}},computed:{clock:function(){return this.simulation.clock.map((e,t)=>[t,e])}},watch:{selectedGates:function(e){this.$nextTick(()=>{this.syncTraces()})}},methods:{syncTraces(){if(0==this.$refs.traces.length)return;let e=this.$refs.traces.map(e=>e.graph);e.push(this.$refs.clock.graph),Dygraph.synchronize(e)},tracedata:function(e){let t=[];for(let n=0;n<this.simulation.time.length;n++)t.push([this.simulation.time[n],this.simulation.gates[e][n]]);return t},traceOptions:function(e){return{height:50,showRangeSelector:!1,xRangePad:5,axes:{x:{drawAxis:!1,drawGrid:!1},y:{drawAxis:!0,drawGrid:!1,axisLabelWidth:5,axisLineColor:"white",axisLabelFormatter:()=>null}},series:{Y1:{color:this.traceColor(e)}}}},traceColor:function(e){return this.isOutput(this.instanceID,e)?"rgb(255,99,132)":this.isInput(this.instanceID,e)?"steelblue":"darkgrey"}},mounted(){}},G=M,L=n("7f41"),$=n("3786"),B=n("4983"),W=Object(l["a"])(G,P,R,!1,null,null,null),Q=W.exports;q()(W,"components",{QTree:L["a"],QRadio:$["a"],QScrollArea:B["a"]});var H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-pa-md q-gutter-md"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-3"},[n("div",{staticClass:"text-subtitle2"},[e._v(e._s(e.file))]),n("q-tree",{attrs:{nodes:e.instanceTree,"node-key":"id","selected-color":"primary",selected:e.instanceID,"default-expand-all":""},on:{"update:selected":function(t){e.instanceID=t}}})],1),n("div",{staticClass:"col-9 q-gutter-md"},[n("div",{staticClass:"row"},[n("q-radio",{attrs:{val:"all",label:"All"},model:{value:e.showWhichGates,callback:function(t){e.showWhichGates=t},expression:"showWhichGates"}}),n("q-radio",{attrs:{val:"inputs",label:"Inputs"},model:{value:e.showWhichGates,callback:function(t){e.showWhichGates=t},expression:"showWhichGates"}}),n("q-radio",{attrs:{val:"outputs",label:"Outputs"},model:{value:e.showWhichGates,callback:function(t){e.showWhichGates=t},expression:"showWhichGates"}})],1),n("q-scroll-area",{staticStyle:{height:"70vh"}},[n("div",{staticClass:"row q-pa-md"},[n("q-markup-table",{staticClass:"full-width"},[n("thead",{staticClass:"bg-teal"},[n("tr",{staticClass:"text-white"},[n("th",{staticClass:"text-left"},[e._v("GlobalID")]),n("th",{staticClass:"text-left"},[e._v("Function")]),n("th",{staticClass:"text-left"},[e._v("Inputs")]),n("th",{staticClass:"text-right"},[e._v("State")])])]),n("tbody",e._l(e.selectedGates,(function(t){return n("tr",{key:t},[n("td",[e._v(e._s(t))]),n("td",[e._v(e._s(e.getGate(t).logic))]),n("td",[e._v(e._s(e.getGate(t).inputs.join(", ")))]),n("td",{staticClass:"text-right"},[e._v(e._s(e.getGate(t).state))])])})),0)])],1)])],1)])])},U=[],X=(n("1c16"),{props:["gates","instances","file"],mixins:[N],data(){return{showWhichGates:"all"}}}),z=X,K=n("2bb1"),V=Object(l["a"])(z,H,U,!1,null,null,null),Y=V.exports;q()(V,"components",{QTree:L["a"],QRadio:$["a"],QScrollArea:B["a"],QMarkupTable:K["a"]});var Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("svg",{ref:"svgSchematic",attrs:{id:"svgSchematic",height:"70vh",width:"100%"}})])},J=[],ee={methods:{stripReactive:e=>JSON.parse(JSON.stringify(e)),log:e=>console.log(stripReactive(e)),getLocalId:e=>e.substr(e.lastIndexOf("_")+1),getNamespace:e=>e.substr(0,e.lastIndexOf("_"))}},te={props:["compiled"],mixins:[ee],data(){return{elkData:{},g:{}}},watch:{compiled:{handler(){this.$nextTick(()=>this.buildNetlist())},immediate:!0,deep:!0}},methods:{onSelect(){console.log(this.g.root.select("#node-id-main_foo_X_gate"))},getGate(e){let t=this.compiled.gates.find(t=>t.id==e);if(!t)throw new Error(`getGate(${e}): gate ${e} does not exist`);return t},getInstance(e){return this.compiled.instances.find(t=>t.id==e)},buildNetlist(){this.elkData={id:"main",hwMeta:{name:"main",maxId:200},properties:{"org.eclipse.elk.portConstraints":"FIXED_ORDER","org.eclipse.elk.randomSeed":0,"org.eclipse.elk.layered.mergeEdges":1},hideChildren:!1,ports:[],children:[],edges:[]},this.buildInstance(this.elkData),console.log("Schematic: ",this.stripReactive(this.elkData)),this.g.bindData(this.elkData),this.$nextTick(()=>console.log(d3.select("svg").selectAll(".node")))},buildInstance(e){const t=this.getInstance(e.id);t.gates.forEach((t,n)=>{const s=this.getGate(t),r={id:s.id+"_gate",hwMeta:{maxId:e.hwMeta.maxId+50+n,cls_name:"gate",name:"control"==s.logic||"buffer"==s.logic||"response"==s.logic?this.getLocalId(s.id):s.logic.toUpperCase(),isExternalPort:"control"==s.logic||"response"==s.logic},properties:{"org.eclipse.elk.portConstraints":"FIXED_ORDER","org.eclipse.elk.randomSeed":0,"org.eclipse.elk.layered.mergeEdges":1},hideChildren:!0,ports:[]};"response"!=s.logic&&r.ports.push({id:s.id,hwMeta:{name:this.getLocalId(s.id)},direction:"OUTPUT",properties:{portSide:"EAST",portIndex:0}}),s.inputs.forEach((t,n)=>{r.ports.push({id:s.id+"_input_"+n,hwMeta:{name:this.getLocalId(s.id)},direction:"INPUT",properties:{portSide:"WEST",portIndex:s.inputs.length>1?n+1:0}}),e.edges.push({id:t+"-"+s.id+"_input_"+n,type:"gate2gate",source:this.compiled.gates.some(e=>"port"==e.type&&e.id==s.inputs[n])?this.getNamespace(s.inputs[n]):s.inputs[n]+"_gate",sourcePort:s.inputs[n],target:s.id+"_gate",targetPort:s.id+"_input_"+n,hwMeta:{name:null}})}),e.children.push(r)}),t.instances.forEach(n=>{const s=this.getInstance(n),r={id:n,hwMeta:{name:n,maxID:e.hwMeta.maxId+100},properties:{"org.eclipse.elk.portConstraints":"FIXED_ORDER","org.eclipse.elk.randomSeed":0,"org.eclipse.elk.layered.mergeEdges":1},hideChildren:!1,ports:[],children:[],edges:[]};s.outputs.forEach(e=>{let t={id:e,hwMeta:{name:this.getLocalId(e)},direction:"OUTPUT",properties:{portSide:"EAST",portIndex:0}};r.ports.push(t);const n=this.getGate(e);this.getGate(e.substr(0,e.indexOf("-out")));r.edges.push({id:e+"_"+n.inputs[0],type:"gate2output",source:n.inputs[0]+"_gate",sourcePort:n.inputs[0],target:this.getNamespace(e),targetPort:e,hwMeta:{name:null}})}),s.inputs.forEach((n,s)=>{let a={id:n,hwMeta:{name:this.getLocalId(n),level:0},direction:"INPUT",properties:{portSide:"WEST",portIndex:s+1}};r.ports.push(a);const i=this.getGate(n);e.edges.push({id:i.inputs[0]+"-"+n,type:"parent2input",hwMeta:{name:null},source:t.inputs.some(e=>e==i.inputs[0])?t.id:i.inputs[0]+"_gate",sourcePort:i.inputs[0],target:this.getNamespace(n),targetPort:n})}),this.buildInstance(r),e.children.push(r)})},zoom(){this.g.root.attr("transform",d3.event.transform)}},mounted(){const e=this.$refs.svgSchematic.clientWidth,t=this.$refs.svgSchematic.clientHeight;var n=d3.select("#svgSchematic").attr("width",e).attr("height",t);this.g=new d3.HwSchematic(n);var s=d3.zoom();s.on("zoom",this.zoom),n.call(s).on("dblclick.zoom",null)}},ne=te,se=(n("22ff"),Object(l["a"])(ne,Z,J,!1,null,null,null)),re=se.exports;q()(se,"components",{QBtn:j["a"]});var ae,ie,oe,ce=n("e123");const le=(e,t)=>{var n;n=""==e?"main":e+"_"+t.id;const s=ae[t.module],r={};var a={id:n,inputs:[],outputs:[],instances:[],gates:[]};s.wires.forEach(e=>{r[e]=`${n}_${e}`}),s.ports.forEach(e=>{r[e.id]=`${n}_${e.id}`}),s.statements.filter(e=>"gate"==e.type).forEach(e=>{const t={id:r[e.id],logic:e.gate,inputs:e.inputs.map(e=>r[e]),instance:n,state:0,type:"gate"};oe.push(t),a.gates.push(t.id)});const i=(e,s)=>{let o;if("BRACKETED_EXPRESSION"==e.type||"ASSIGN_EXPRESSION"==e.type){let c=e.value;for(let e=1;e<c.length;e+=2){let l=e==c.length-2?s:s+"op"+e;r[l]||(r[l]=`${n}.${l}`),oe.push({id:r[l],logic:c[e].value,inputs:[1==e?i(c[e-1],s+"op"+(e-1)):r[o],i(c[e+1],s+"op"+(e+1))],state:0,type:"gate",instance:t.id}),a.gates.push(r[l]),o=l}return r[o]}if("VARIABLE"==e.type)return o=e.value,e.invert?(r["not"+o]||(r["not"+o]=`${n}_not${o}`,oe.push({id:r["not"+o],logic:"not",inputs:[r[o]],state:0,type:"gate",instance:t.id}),a.gates.push(r["not"+o])),r["not"+o]):r[o];throw new Error("vlgWalker shouldn't be here. Node is not VARIABLE or EXPRESSION")};return s.statements.filter(e=>"assign"==e.type).forEach(e=>i(e.value,e.id)),s.ports.forEach(s=>{const i={id:`${n}_${s.id}`+("output"==s.type?"-out":""),logic:"buffer",instance:n,inputs:[],state:0,type:"port"};if("input"==s.type){const n=t.parameters.find(e=>e.port==s.id);n&&(i.inputs.push(`${e}_${n.value.id}`),a.inputs.push(r[s.id]))}if("output"==s.type){const n=t.parameters.find(e=>e.port==s.id);if(n){const t=oe.find(t=>t.id==`${e}_${n.value.id}`);if(!t)throw new Error(`${n.value.id} is not a gate in ${e}`);t.inputs.push(i.id);const o=oe.find(e=>e.id==r[s.id]);o&&i.inputs.push(r[s.id]),a.outputs.push(i.id)}}oe.push(i)}),s.statements.filter(e=>"instance"==e.type).forEach(e=>{var t=le(n,e);a.instances.push(t.id)}),a.varMap=r,ie.push(a),a},de=e=>{ae=e.reduce((e,t)=>(e[t.id]=t,e),{}),oe=[],ie=[];const t={id:"main",module:"main",parameters:[]};return le("",t),{instances:ie,gates:oe}};var ue=de,pe=(n("abb2"),n("fcf3")),he=n("47d0"),me="// One bit full adder\r\n\r\nmodule SingleStage (\r\n  input a,\r\n  input b,\r\n  input cin,\r\n  output s,\r\n  output cout );\r\n\r\n  wire w1, w2, w3;\r\n\r\n  and( w1, a, b );\r\n  and( w2, a, cin );\r\n  and( w3, b, cin );\r\n  or( cout, w1, w2, w3 );\r\n\r\n  xor( s, a, b, cin );\r\n\r\nendmodule\r\n\r\nmodule main;\r\n\r\n  wire a, b, cin;\r\n  wire sum, cout;\r\n\r\n  control(a);\r\n  control(b);\r\n  control(cin);\r\n\r\n  SingleStage uut(\r\n\t\t.a(a),\r\n\t\t.b(b),\r\n\t\t.cin(cin),\r\n\t\t.s(sum),\r\n\t\t.cout(cout)\r\n  );\r\n\r\n  response(sum);\r\n  response(cout);\r\n\r\n\ttest begin\r\n\t\t#0  {a=0, b=0, cin=0};\r\n    #2  {a=0, b=0, cin=0};\r\n    #4  {a=0, b=0, cin=1};\r\n    #6  {a=0, b=1, cin=0};\r\n    #8  {a=0, b=1, cin=1};\r\n    #10 {a=1, b=0, cin=0};\r\n    #12 {a=1, b=0, cin=1};\r\n    #14 {a=1, b=1, cin=0};\r\n    #16 {a=1, b=1, cin=1};\r\n    #18;\r\n\tend\r\nendmodule",ge="// D Flip Flop\r\n\r\nmodule DFF (\r\n\tinput clk,\r\n\tinput dIn,\r\n\toutput q3);\r\n\r\n\twire not_d_in, d_nand_a, d_nand_c, q_;\r\n\r\n\tnot( not_d_in, dIn );\r\n\tnand( d_nand_a, dIn, clk );\r\n\tnand( q3, d_nand_a, q_ );\r\n\tnand( d_nand_c, not_d_in, clk );\r\n  nand( q_, d_nand_c, q3);\r\nendmodule\r\n\r\nmodule DFFE (\r\n  input clk,\r\n  input dIn,\r\n  input dEnable,\r\n  output q2);\r\n\r\n  wire gatedClk;\r\n  and(gatedClk, clk, dEnable);\r\n  \r\n  DFF dff(.clk(gatedClk), .dIn(dIn), .q3(q2));\r\n\r\n\r\nendmodule\r\n\r\nmodule main;\r\n\r\n  wire A, E, clock, q1;\r\n\r\n  control(A);\r\n  control(E);\r\n  control(clock);\r\n\r\n  DFFE dffe(.clk(clock), .dIn(A), .dEnable(E), .q2(q1));\r\n\r\n  response(q1);\r\n\r\n  test begin\r\n    #0  { E=1 };\r\n    #1  { A=1, E=0 };\r\n    #7  { E=1 };\r\n    #9  { A=0, E=0 };\r\n    #12;\r\n  end\r\nendmodule",be="// template to show basic syntax\r\n\r\nmodule MyModule (\r\n  input a, b,\r\n  output X, Y );\r\n\r\n  // gate format: logicFn(id, input1, input2)\r\n  and( X, a, b );\r\n  or(  Y, a, b );\r\n\r\n  // alternative bitwise format\r\n  // assign X = a & b;\r\n  // assign Y = A | b;\r\nendmodule\r\n\r\nmodule main; // main has no inputs or outputs, instead control and response wires\r\n\r\n  // wires act as local variables/gates\r\n  wire user1, user2; // control gates\r\n  wire o1, o2; // response gates\r\n\r\n  // control is an external button/sensor\r\n  // control state is set in the testbench\r\n  // only module main can have control wires\r\n  control(user1);\r\n  control(user2);\r\n\r\n  // declare foo as an instance (copy) of MyModule\r\n  // map the input/output parameters of MyModule to the calling namespace\r\n  // .moduleParameter(callingNamespaceVariable)\r\n  MyModule foo(\r\n\t\t.a(user1),\r\n\t\t.b(user2),\r\n\t\t.X(o1),\r\n\t\t.Y(o2)\r\n  );\r\n\r\n  // foo needs something to wire it's outputs to in main\r\n  response(o1);\r\n  response(o2);\r\n\r\n  // main module should have a testbench to set control states\r\n  // format: #time {controlVar=val,...}\r\n  test begin\r\n    #0  {user1=0, user2=0};\r\n    #2  {user1=0, user2=1};\r\n    #4  {user1=1, user2=0};\r\n    #6  {user1=1, user2=1};\r\n  end\r\nendmodule",fe="/* 2 to 4 one hot decoder\r\na b | F3 F2 F1 F0\r\n0 0 |  0  0  0  1 \r\n0 1 |  0  0  1  0\r\n1 0 |  0  1  0  0\r\n1 1 |  1  0  0  0\r\n*/\r\n\r\n// using bitwise assigns\r\nmodule OneHotDecoderBitwise (\r\n  input a, b,\r\n  output F3, F2, F1, F0);\r\n\r\n  assign F0 = ~a & ~b;\r\n  assign F1 = ~a & b;\r\n  assign F2 = a & ~b;\r\n  assign F3 = a & b;\r\nendmodule\r\n\r\n// using standard gate statements\r\nmodule OneHotDecoder (\r\n  input a, b,\r\n  output F3, F2, F1, F0);\r\n\r\n  wire nota, notb;\r\n  not(nota, a);\r\n  not(notb, b);\r\n\r\n  and(F0, nota, notb);\r\n  and(F1, nota, b);\r\n  and(F2, a, notb);\r\n  and(F3, a, b);\r\nendmodule\r\n\r\nmodule main;\r\n\r\n  wire a, b; // controls\r\n  wire F3, F2, F1, F0; // response\r\n\r\n  control(a);\r\n  control(b);\r\n\r\n  // OneHotDecoder ohd(\r\n  OneHotDecoderBitwise ohd(\r\n\t\t.a(a),\r\n\t\t.b(b),\r\n\t\t.F3(F3),\r\n\t\t.F2(F2),\r\n\t\t.F1(F1),\r\n\t\t.F0(F0)\r\n  );\r\n\r\n  response(F3);\r\n  response(F2);\r\n  response(F1);\r\n  response(F0);\r\n\r\n  test begin\r\n\t\t#0  {a=0, b=0};\r\n    #2  {a=0, b=1};\r\n    #4  {a=1, b=0};\r\n    #6  {a=1, b=1};\r\n    #8;\r\n\tend\r\nendmodule",ve="/* 7 segment display decoder\r\n  a\r\nf   b\r\n  g\r\ne   c\r\n  d\r\n\r\nA B C | Fa Fb Fc Fd Fe Ff Fg\r\n0 0 0 |  1  1  1  1  1  1  0 \r\n0 0 1 |  0  1  1  0  0  0  0\r\n0 1 0 |  1  1  0  1  1  0  1\r\n0 1 1 |  1  1  1  1  0  0  1\r\n1 0 0 |  0  1  1  0  0  1  1 \r\n1 0 1 |  1  0  1  1  0  1  1\r\n1 1 0 |  1  0  1  1  1  1  1\r\n1 1 1 |  1  1  1  0  0  0  0\r\n*/\r\n\r\n// using standard gate statements\r\nmodule SevenSeg(\r\n  input A, B, C,\r\n  output Fa, Fb, Fc, Fd, Fe, Ff, Fg);\r\n\r\n  assign Fa = (~A & ~C) | B        | (A & C);\r\n  assign Fb = (~B & ~C) | ~A       | (B & C);\r\n  assign Fc = A         | ~B       | C;\r\n  assign Fd = (~A & ~C) | (~A & B) | (B & ~C) | (A & ~B & C);\r\n  assign Fe = (~A & ~C) | (B & ~C);\r\n  assign Ff = (~B & ~C) | (A & ~C) | (A & ~B);\r\n  assign Fg = (~A & B)  | (A & ~C) | (A & ~B);\r\nendmodule\r\n\r\nmodule main;\r\n\r\n  wire Fa, Fb, Fc, Fd, Fe, Ff, Fg;\r\n  wire a, b, c;\r\n\r\n  control(a);\r\n  control(b);\r\n  control(c);\r\n\r\n  SevenSeg ss(\r\n\t\t.A(a),\r\n\t\t.B(b),\r\n\t\t.C(c),\r\n    .Fa(Fa),\r\n    .Fb(Fb),\r\n    .Fc(Fc),\r\n    .Fd(Fd),\r\n    .Fe(Fe),\r\n    .Ff(Ff),\r\n    .Fg(Fg)\r\n  );\r\n\r\n  response(Fa);\r\n  response(Fb);\r\n  response(Fc);\r\n  response(Fd);\r\n  response(Fe);\r\n  response(Ff);\r\n  response(Fg);\r\n\r\n  test begin\r\n    #00 {a=0, b=0, c=0}; // should get 1 1 1 1 1 1 0\r\n    #02 {a=0, b=0, c=1}; // should get 0 1 1 0 0 0 0\r\n    #04 {a=0, b=1, c=0}; // should get 1 1 0 1 1 0 1\r\n    #06 {a=0, b=1, c=1}; // should get 1 1 1 1 0 0 1\r\n    #08 {a=1, b=0, c=0}; // should get 0 1 1 0 0 1 1 \r\n    #10 {a=1, b=0, c=1}; // should get 1 0 1 1 0 1 1\r\n    #12 {a=1, b=1, c=0}; // should get 1 0 1 1 1 1 1\r\n    #14 {a=1, b=1, c=1}; // should get 1 1 1 0 0 0 0\r\n    #16;\r\n\tend\r\nendmodule",ye="/* 2 to 1 Multiplexer\r\nSel selects which input to pass to output\r\nsel a b | F\r\n 0  0 0 | 0 \r\n 0  0 1 | 0 \r\n 0  1 0 | 1 \r\n 0  1 1 | 1 \r\n----------- \r\n 1  0 0 | 0\r\n 1  0 1 | 1\r\n 1  1 0 | 0\r\n 1  1 1 | 1\r\n */\r\n\r\nmodule Mux2_1 (\r\n\tinput sel,\r\n\tinput a, b,\r\n\toutput F);\r\n\r\n\tassign F = (~sel & a) | (sel & b);\r\nendmodule\r\n\r\nmodule main;\r\n  wire a, b, sel;\r\n  wire F;\r\n\r\n  control(a);\r\n  control(b);\r\n  control(sel);\r\n\r\n  Mux2_1 mux(.a(a), .b(b), .sel(sel), .F(F));\r\n  response(F);\r\n\r\n  test begin\r\n    #01 {sel=0, a=0, b=0}; // expect 0 \r\n    #02 {sel=0, a=0, b=1}; // expect 0 \r\n    #03 {sel=0, a=1, b=0}; // expect 1 \r\n    #04 {sel=0, a=1, b=1}; // expect 1 \r\n    #05 {sel=1, a=0, b=0}; // expect 0\r\n    #06 {sel=1, a=0, b=1}; // expect 1\r\n    #07 {sel=1, a=1, b=0}; // expect 0\r\n    #08 {sel=1, a=1, b=1}; // expect 1\r\n    #09;\r\n  end\r\nendmodule",Oe='/* 1 to 2 DeMultiplexer\r\nSel selects which output to send the input to\r\nsel a | Y Z\r\n 0  0 | 0 0 \r\n 0  1 | 1 0 \r\n 1  0 | 0 0 \r\n 1  1 | 0 1 \r\n */\r\n\r\nmodule DeMux (\r\n\tinput sel,\r\n\tinput a,\r\n\toutput Y, Z);\r\n\r\n\tassign Y = ~sel & a;\r\n  assign Z = sel & a;\r\nendmodule\r\n\r\nmodule main;\r\n  wire Y, Z;\r\n  wire clock, sel;\r\n\r\n  control(sel);\r\n  control(clock); // "clock" is controlled automatically during test\r\n\r\n  DeMux demux(.a(clock), .sel(sel), .Y(Y), .Z(Z));\r\n  response(Y);\r\n  response(Z);\r\n\r\n  test begin\r\n    #001 {sel=0};  \r\n    #010 {sel=1}; \r\n    #020;\r\n  end\r\nendmodule',we="// Ripple counter\r\n\r\nmodule DFF (\r\n  input clk, dIn,\r\n  output q, q_);\r\n\r\n  wire not_d_in, d_nand_a, d_nand_c;\r\n\r\n  not( not_d_in, dIn );\r\n  nand( d_nand_a, dIn, clk );\r\n  nand( q, d_nand_a, q_ );\r\n  nand( d_nand_c, not_d_in, clk );\r\n  nand( q_, d_nand_c, q);\r\nendmodule\r\n\r\nmodule main;\r\n\r\n  wire clock, qn1, qn2;\r\n  wire count0, count1;\r\n\r\n  control(clock);\r\n\r\n  response(count0);\r\n  response(count1);\r\n  \r\n  buffer(qn1);\r\n  buffer(qn2);\r\n\r\n  DFF u1(.clk(clock), .dIn(qn1), .q(count0), .q_(qn1));\r\n  DFF u2(.clk(qn1),   .dIn(qn2), .q(count1), .q_(qn2));\r\n\r\n  test begin\r\n    #20;\r\n  end\r\nendmodule",_e=n("2b0e");const xe=n("53f4");let Ee={enabled:!0,level:2};const Ce=new xe.Instance(Ee),ke=e=>{const t=e.join(", ");return t.length<21?t:t.slice(0,40)+"..."},Fe=(e,t)=>e.reduce((e,n)=>(e[n[t]]=n,e),{}),je=e=>1&~e,Ie={not:e=>1&~e,buffer:e=>e,response:e=>e,and2:(e,t)=>e&&t,nand2:(e,t)=>je(e&&t),or2:(e,t)=>e||t,nor2:(e,t)=>je(e||t),xor2:(e,t)=>e^t,xnor2:(e,t)=>je(e^t),and3:(e,t,n)=>e&&t&&n,nand3:(e,t,n)=>je(e&&t&&n),or3:(e,t,n)=>e||t||n,nor3:(e,t,n)=>je(e||t||n),xor3:(e,t,n)=>e^t^n,xnor3:(e,t,n)=>je(e^t^n)},Se=(e,t)=>{const n=e=>{let n=e.logic;if(1==e.inputs.length){if("not"!=n&&"buffer"!=n&&"response"!=n)return void console.log("Gate evaluation error - 1 input only valid for not and buffer gates");const s=t[e.inputs[0]];if(!s)throw console.log(e.inputs[0]),new Error("component not found");return void(e.state="x"===s?"x":Ie[n](s.state))}const s=t[e.inputs[0]],r=t[e.inputs[1]];if(2!=e.inputs.length)if(3!=e.inputs.length);else{const a=t[e.inputs[2]];e.state="x"===s||"x"===r||"x"===a?"x":Ie[n+"3"](s.state,r.state,a.state)}else e.state="x"===s||"x"===r?"x":Ie[n+"2"](s.state,r.state)};e.forEach(e=>{if("control"!==e.logic)return n(e)})};var Te={name:"Index",mixins:[ee],components:{Editor:u,Graph:D,Gates:Y,Trace:Q,Schematic:re},data(){return{EVALS_PER_STEP:5,terminal:{},showTerminal:!0,fitAddon:{},compiled:{timestamp:null,state:"uncompiled",sourceFile:"",parseTree:{lint:[]},gates:[],instances:[],simulation:{gates:{},time:[],maxTime:0}},tab:"code",layout:"dagre",source:{BitAdder:me,DFF:ge,Scratch:be,OneHotDecoder:fe,SevenSeg:ve,Mux2_1:ye,DeMux:Oe,RippleCounter:we},sourceTab:"Scratch",openFiles:["Scratch","OneHotDecoder","SevenSeg","Mux2_1","DeMux","RippleCounter","BitAdder"],errors:{}}},computed:{allFiles:function(){return Object.keys(this.source)},compileIcon:function(){return"success"==this.compiled.state?"check_circle":"error"==this.compiled.state?"error_outline":"replay"}},methods:{closeFile:function(){var e=this.openFiles.findIndex(e=>e==this.sourceTab);this.openFiles.splice(e,1),this.sourceTab=this.openFiles[e%this.openFiles.length]},sourceErrors:function(e){return this.errors[e]},onParsed(e,t){_e["a"].set(this.errors,e,t)},onOpenFile(e){this.openFiles.some(t=>t==e)||this.openFiles.push(e),this.sourceTab=e},termWriteln(e){this.terminal.write(e+"\n\r"),this.terminal.scrollToBottom()},compile(){this.showTerminal=!0;const e={};e.sourceFile=this.sourceTab,this.termWriteln(Ce.bold.green("• Compiling: ")+Ce.yellow(this.sourceTab));const t=Object(ce["a"])(this.source[this.sourceTab]).parseState;if(console.log("Parse: ",this.stripReactive(t)),t.isError)return e.state="error",void this.termWriteln(Ce.red("└── Parser error: ")+t.error);e.state="success",e.parseTree=t.result,this.termWriteln(Ce.green(`├── Parsed ${e.parseTree.length} modules: ${Ce.white(e.parseTree.map(e=>e.id).join(", "))}`));const n=ue(e.parseTree);console.log("Compiled: ",this.stripReactive(n)),e.instances=[...n.instances],e.gates=[...n.gates],this.termWriteln(Ce.green(`├── Generated ${e.instances.length} instances: ${Ce.white(ke(e.instances.map(e=>e.id)))}`)),this.termWriteln(Ce.green(`└── Generated ${e.gates.length} gates: ${Ce.white(ke(e.gates.map(e=>e.id)))}`)),this.termWriteln(Ce.green.inverse(" DONE ")+"  Compiled successfully"),e.timestamp=Date.now(),this.compiled=e},onNodeClick(e,t){const n=this.compiled.gates.find(t=>t.id==e);if(n&&"control"==n.logic){n.state=1&~n.state;var s=Fe(this.compiled.gates,"id");for(let e=0;e<this.EVALS_PER_STEP;e++)Se(this.compiled.gates,s);this.$refs.graph.showLogicStates()}},simulate(){this.showTerminal=!0,this.termWriteln(Ce.bold.cyan("• Simulating: ")+Ce.yellow(this.compiled.sourceFile));const e={gates:{},clock:[],time:[]};this.compiled.gates.forEach(t=>{t.state=0,e.gates[t.id]=[]});var t=Fe(this.compiled.gates,"id"),n=Fe(this.compiled.instances,"id"),s=Fe(this.compiled.parseTree,"id");const r=s.main.clock.reduce((e,t)=>Math.max(t.time,e),0);t["main_clock"]&&(t["main_clock"].state=0);for(let a=0;a<=r;a++){e.time.push(a),s.main.clock.forEach(e=>{e.time==a&&e.assignments.forEach(e=>{"control"==t["main_"+e.id].logic&&(t["main_"+e.id].state=e.value)})}),t["main_clock"]&&(t["main_clock"].state=1&~t["main_clock"].state);for(let e=0;e<this.EVALS_PER_STEP;e++)Se(this.compiled.gates,t);this.compiled.gates.forEach(n=>{e.gates[n.id].push(t[n.id].state)}),e.clock.push(a%2),s.main.clock.forEach((e,s,r)=>{if(e.time!=a)return;const i=s==r.length-1?"└":"├";this.termWriteln(Ce.cyan(`${i}── Time ${a.toString().padStart(3,"0")} :`)+ke(e.assignments.map(e=>e.id+"="+e.value))+Ce.cyan(" => ")+ke(n.main.gates.filter(e=>"response"==t[e].logic).map(e=>this.getLocalId(e)+"="+t[e].state)))})}this.termWriteln(Ce.cyan.inverse(" DONE ")+"  Simulated successfully"),e.maxTime=e.time[e.time.length-1],e.timestamp=Date.now(),this.compiled.simulation=e,console.log("Simulation: ",this.stripReactive(this.compiled.simulation))}},mounted(){this.terminal=new pe["Terminal"]({rows:40}),this.fitAddon=new he["FitAddon"],this.terminal.loadAddon(this.fitAddon),this.terminal.open(document.getElementById("terminal")),this.fitAddon.fit()}},qe=Te,Ae=(n("8041"),n("9989")),De=n("429b"),Pe=n("7460"),Re=n("adad"),Ne=n("823b"),Me=n("65c6"),Ge=n("2c91"),Le=n("58a81"),$e=n("0016"),Be=n("f20b"),We=n("1c1c"),Qe=n("66e5"),He=n("4074"),Ue=n("0170"),Xe=n("7f67"),ze=Object(l["a"])(qe,s,r,!1,null,null,null);t["default"]=ze.exports;q()(ze,"components",{QPage:Ae["a"],QTabs:De["a"],QTab:Pe["a"],QTabPanels:Re["a"],QTabPanel:Ne["a"],QToolbar:Me["a"],QSpace:Ge["a"],QBadge:Le["a"],QIcon:$e["a"],QBtnDropdown:Be["a"],QList:We["a"],QItem:Qe["a"],QItemSection:He["a"],QItemLabel:Ue["a"],QBtn:j["a"],QCard:C["a"],QSeparator:S["a"],QCardSection:k["a"]}),q()(ze,"directives",{ClosePopup:Xe["a"]})},a12c:function(e,t,n){},a14e:function(e,t,n){},a796:function(e,t,n){"use strict";var s=n("1f8d"),r=n.n(s);r.a},bad6:function(e,t,n){"use strict";(function(e){var s=n("8f94"),r=n("56b3"),a=n.n(r),i=(n("76ae"),n("10b2"),n("8c33"),n("8822"),n("0dd0"),n("9b74"),n("f6b6"),n("7289"),n("4895"),n("cbc8"),n("697e"),n("e123"));n("bdf0"),n("a7be"),n("7a7a");e.CodeMirror=a.a;var o=n("5068");t["a"]={components:{codemirror:s["codemirror"]},props:["value"],data(){return{parser:i["a"],cmOptions:{viewportMargin:1/0,tabSize:2,indentUnit:2,mode:"vlg",theme:"monokai",lineNumbers:!0,line:!0,extraKeys:{"Ctrl-Space":"autocomplete","Shift-Ctrl-Space":"snippet","Ctrl-/":"toggleComment","Ctrl-Q":function(e){e.foldCode(e.getCursor())}},lint:{selfContain:!0,getAnnotations:this.vlgValidator},autoCloseBrackets:!0,matchBrackets:!0,gutters:["CodeMirror-lint-markers","CodeMirror-linenumbers","CodeMirror-foldgutter"],foldGutter:!0}}},methods:{vlgValidator:function(e,t,n){if(0==e.length)return[];var s=[];const r=this.parser(e);var i=o(e,{origin:0});const c=(t,n,r)=>{var o=i.fromIndex(n),c=i.fromIndex(Math.max(e.regexIndexOf(/[\s\(\)\[\]\{\},=]/,n),n));s.push({message:t,severity:r,from:a.a.Pos(o.line,o.col),to:a.a.Pos(c.line,c.col)})};return r.lint.forEach(e=>c(e.error,e.index,e.severity)),r.parseState.isError&&0==r.lint.length&&c(r.parseState.error,r.parseState.index),this.$emit("parsed",s),s},onReady(e){},onChange(e){this.$emit("input",e)}},computed:{codemirror(){return this.$refs.cmEditor.codemirror}},mounted(){}}}).call(this,n("c8ba"))},bdf0:function(e,t,n){"use strict";n("c975"),n("fb6a"),n("4e82");var s=n("56b3"),r=n.n(s);n("5068");String.prototype.regexIndexOf=function(e,t){var n=this.substring(t||0).search(e);return n>=0?n+(t||0):n},r.a.defineSimpleMode("vlg",{meta:{lineComment:"//"},start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"string"},{regex:/(?:module|begin)/,token:"def",indent:!0},{regex:/(?:input|output|endmodule|end)\b/,token:"def"},{regex:/(?:not|and|or|xor|nand|control|buffer|response)\b/,token:"keyword"},{regex:/(?:wire|test|assign)\b/,token:"variable-2"},{regex:/true|false|null|undefined/,token:"atom"},{regex:/0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i,token:"number"},{regex:/\/\/.*/,token:"comment"},{regex:/\/(?:[^\\]|\\.)*?\//,token:"variable-3"},{regex:/\/\*/,token:"comment",next:"comment"},{regex:/[-+\/*=<>!]+/,token:"operator"},{regex:/[\{\[\(]/,indent:!0},{regex:/[\}\]\)]/,dedent:!0},{regex:/[a-zA-Z$][\w$]*/,token:"variable"}],comment:[{regex:/.*?\*\//,token:"comment",next:"start"},{regex:/.*/,token:"comment"}]}),r.a.registerHelper("fold","vlg",(function(e,t){function n(e,t){var n=t&&t.match(/^(begin|module)+/);return n}var s=e.getLine(t.line),a=n(t.line,s);if(a){var i=e.lastLine(),o=t.line,c=e.getLine(o+1);while(o<i){if(n(o+1,c))break;++o,c=e.getLine(o+1)}return{from:r.a.Pos(t.line,s.length),to:r.a.Pos(o,e.getLine(o).length)}}}));var a={start:["nand(","and(","or(","xor(","nor(","not(","control(","response(","buffer(","input","output","wire","assign"],none:["module"]};r.a.registerHelper("hint","dictionaryHint",(function(e){var t=e.getCursor(),n=e.getLine(t.line),s=t.ch,i=s,o=e.getTokenAt(e.getCursor()).state;while(i<n.length&&/[\w$]/.test(n.charAt(i)))++i;while(s&&/[\w$]/.test(n.charAt(s-1)))--s;var c=s!==i&&n.slice(s,i),l=new RegExp("^"+c,"i");return{list:(c?a[o.state].filter((function(e){return e.match(l)})):a[o.state]).sort(),from:r.a.Pos(t.line,s),to:r.a.Pos(t.line,i)}})),r.a.commands.autocomplete=function(e){r.a.showHint(e,r.a.hint.dictionaryHint)},r.a.commands.snippet=function(e){r.a.showHint(e,o)};const i=[{text:"module Name (\n   input A,B,C,\n   output X,Y);\n   // statements here\nendmodule",displayText:"module definition"},{text:"ModuleName instanceName(\n  .p1(m1), // .instanceParamater(LocalVar)\n  .p2(m2),\n  .p3(m3)\n);",displayText:"instance declaration"},{text:"and(gateID, input1, input2);",displayText:"gate declaration"},{text:"assign ID = (A & B);",displayText:"assign declaration"}];function o(e){const t=e.getCursor(),n=e.getTokenAt(t),s=n.start,a=t.ch,o=t.line,c=n.string,l=i.filter((function(e){return e.text.indexOf(c)>=0}));return{list:l.length?l:i,from:r.a.Pos(o,s),to:r.a.Pos(o,a)}}},cb9a:function(e,t,n){},e123:function(e,t,n){"use strict";n("0481"),n("fb6a"),n("4069"),n("ddb0");var s=n("e0a5"),r=[],a=[],i=[],o=0,c=[];const l=(e,t)=>(n,s)=>(c.push({index:s,error:e,severity:t||"error"}),e),d=(e,t)=>t.from?t.from:t.back?e.index-t.back:e.index-t,u=(e,t,n)=>Object(s["u"])(s=>l(e,t)("",d(s,n))),p=Object(s["u"])(e=>o=e.index).map(e=>o),h=e=>t=>({type:e,value:t}),m=e=>e[e.length-1],g=Object(s["k"])(Object(s["p"])(/^./)),b=Object(s["r"])([Object(s["s"])("//"),Object(s["i"])(Object(s["c"])("\n")),s["n"]]),f=Object(s["r"])([Object(s["s"])("/*"),Object(s["i"])(Object(s["s"])("*/")),Object(s["s"])("*/")]),v=Object(s["l"])(Object(s["d"])([s["v"],b,f])).map(e=>e||""),y=e=>Object(s["b"])(v)(v)(e),O=Object(s["q"])(y(Object(s["c"])(","))),w=(Object(s["q"])(y(Object(s["c"])(";"))),Object(s["b"])(y(Object(s["c"])("(")))(y(Object(s["c"])(")")))),_=Object(s["b"])(y(Object(s["c"])("{")))(y(Object(s["c"])("}"))),x=Object(s["b"])(y(Object(s["c"])("[")))(y(Object(s["c"])("]"))),E=Object(s["p"])(/^[0-1]/).map(e=>parseInt(e)),C=["module","begin","input","output","wire","assign","endmodule","buffer","and","not","or","xor","nor","nand"],k=Object(s["e"])((function*(){const e=yield Object(s["g"])(y(Object(s["r"])([Object(s["p"])(/^[a-zA-Z_]/),Object(s["o"])(Object(s["p"])(/^[a-zA-Z0-9_]+/)).map(e=>null===e?"":e)])).map(e=>e.join("")));return e.isError&&(yield Object(s["j"])("Invalid ID")),C.some(t=>t==e.value)&&(yield Object(s["j"])("Identifier cannot be keyword")),e.value})),F=(Object(s["e"])((function*(){const e=yield s["f"];yield Object(s["s"])("'");const t=yield Object(s["s"])("b"),n=yield s["f"];return{type:"number",bits:e,base:t,value:n}})),Object(s["e"])((function*(){const e=yield k;return r.some(t=>t==e)||(yield Object(s["u"])(t=>l("Undefined variable","warning")("",t.index-e.length))),e}))),j=e=>t=>(console.log(e+":",t),t),I=Object(s["e"])((function*(){const e=yield k.errorMap(l("Invalid identifier"));return a.some(t=>t==e)||(yield Object(s["u"])(t=>l("Must be control variable","warning")("",t.index-e.length))),e})),S=Object(s["e"])((function*(){const e=yield F,t=yield Object(s["o"])(x(s["f"]));return{id:e,index:t}})),T=Object(s["e"])((function*(){const e=yield Object(s["r"])([Object(s["s"])("."),k]).map(e=>e[1]),t=yield w(S);return{port:e,value:t}})),q=Object(s["e"])((function*(){yield s["n"];const e=yield p,t=yield y(k).errorMap(e=>"no module"),n=yield y(k).errorMap(e=>"no id"),r=yield w(O(y(T)));yield Object(s["s"])(";");const a=i.find(e=>e==t);return a||(yield u("Module "+t+" not defined","warning",{from:e})),{type:"instance",module:t,id:n,parameters:r}})),A=Object(s["e"])((function*(){const e=yield Object(s["d"])([Object(s["s"])("and"),Object(s["s"])("nand"),Object(s["s"])("or"),Object(s["s"])("xor"),Object(s["s"])("nor"),Object(s["s"])("not"),Object(s["s"])("control"),Object(s["s"])("buffer"),Object(s["s"])("response")]),t=yield p,n=yield w(O(F));return["control","buffer","response"].includes(e)&&1!=n.length&&(yield u(`'${e}' expects exactly 1 parameter`,"warning",{from:t})),["and","nand","or","xor","nor"].includes(e)&&n.length<3&&(yield u(`'${e}' expects at least 3 parameters`,"warning",{from:t})),yield y(Object(s["s"])(";")),{type:"gate",id:n[0],gate:e,inputs:n.slice(1)}})),D=Object(s["d"])([Object(s["c"])("&").map(e=>({type:"OP_AND",value:"and"})),Object(s["c"])("|").map(e=>({type:"OP_OR",value:"or"})),Object(s["c"])("^").map(e=>({type:"OP_XOR",value:"xor"})),Object(s["s"])("~&").map(e=>({type:"OP_NAND",value:"nand"})),Object(s["s"])("~|").map(e=>({type:"OP_NOR",value:"nor"}))]),P=Object(s["r"])([Object(s["o"])(Object(s["c"])("~")),F]).map(([e,t])=>({type:"VARIABLE",value:t,invert:null!=e})),R=e=>{const t=h("BRACKETED_EXPRESSION");return t(e.map(e=>Array.isArray(e)?R(e):e))},N=Object(s["e"])((function*(){const e={OPEN_BRACKET:0,OPERATOR_OR_CLOSING_BRACKET:1,ELEMENT_OR_OPENING_BRACKET:2,CLOSE_BRACKET:3};let t=e.ELEMENT_OR_OPENING_BRACKET;const n=[],r=[n];yield Object(s["c"])("(");while(1){const a=yield g;if(t===e.OPEN_BRACKET)yield Object(s["c"])("("),n.push([]),r.push(m(n)),yield s["n"],t=e.ELEMENT_OR_OPENING_BRACKET;else if(t===e.CLOSE_BRACKET){if(yield Object(s["c"])(")"),r.pop(),0===r.length)break;yield s["n"],t=e.OPERATOR_OR_CLOSING_BRACKET}else if(t===e.ELEMENT_OR_OPENING_BRACKET)")"===a&&(yield Object(s["j"])("Unexpected end of expression")),"("===a?t=e.OPEN_BRACKET:(m(r).push(yield P),yield s["n"],t=e.OPERATOR_OR_CLOSING_BRACKET);else{if(t!==e.OPERATOR_OR_CLOSING_BRACKET)throw new Error("Unknown state");if(")"===a){t=e.CLOSE_BRACKET;continue}m(r).push(yield D),yield s["n"],t=e.ELEMENT_OR_OPENING_BRACKET}}return R(n)})),M=Object(s["e"])((function*(){yield s["n"];const e={EXPECT_ELEMENT:0,EXPECT_OPERATOR:1},t=[];let n=e.EXPECT_ELEMENT;while(1)if(n===e.EXPECT_ELEMENT){const r=yield Object(s["d"])([N,P]);t.push(r),n=e.EXPECT_OPERATOR,yield s["n"]}else if(n===e.EXPECT_OPERATOR){const r=yield g;if(";"===r){yield Object(s["c"])(";"),yield s["n"];break}const a=yield D;t.push(a),n=e.EXPECT_ELEMENT,yield s["n"]}return h("ASSIGN_EXPRESSION")(t)})),G=Object(s["e"])((function*(){yield Object(s["s"])("assign ");const e=yield y(k).errorMap(l("Invalid assign identifier"));yield y(Object(s["s"])("="));const t=yield M.errorMap(l("Invalid expression"));return{type:"assign",id:e,value:t}})),L=Object(s["e"])((function*(){const e=yield x(Object(s["r"])([s["f"],Object(s["s"])(":"),s["f"]])).map(e=>[e[0],e[2]]);return e})),$=Object(s["r"])([y(k),Object(s["l"])(Object(s["t"])(Object(s["s"])(","))(y(k)))]).map(e=>e.flat()).errorMap(l("Invalid port identifier")),B=Object(s["e"])((function*(){const e=yield Object(s["d"])([y(Object(s["s"])("input")),y(Object(s["s"])("output"))]).errorMap(l("Invalid port type: must be 'input' or 'output'")),t=yield Object(s["o"])(L),n=yield $.errorMap(j("Invalid port identifier33333"));return n.map(n=>({type:e,dim:t,id:n}))})),W=Object(s["e"])((function*(){yield Object(s["s"])("wire ");const e=yield O(y(k).errorMap(l("Invalid wire identifier")));return yield y(Object(s["s"])(";")),e})),Q=Object(s["e"])((function*(){yield Object(s["s"])("module ").errorMap(l("Expecting 'module'"));const e=yield y(k).errorMap(l("Invalid module identifier")),t=yield Object(s["o"])(w(O(B.errorMap(l("Invalid ports section")))).map(e=>e.flat())).map(e=>e||[]);yield y(Object(s["s"])(";"));var n=yield Object(s["l"])(y(W)).map(e=>e.flat());n=n||[],r=[...t.map(e=>e.id),...n],a=[];const o=yield Object(s["l"])(Object(s["d"])([y(A),y(q),y(G)]));var c;o.forEach(e=>{"control"==e.gate&&a.push(e.id)}),"main"==e&&(c=yield X.errorMap(l("Invalid test block"))),yield y(Object(s["s"])("endmodule"));var d={type:"module",id:e,ports:t.flat(),wires:n,statements:o};return c&&(d.clock=c),i.push(e),d})),H=Object(s["e"])((function*(){const e=yield y(I);yield Object(s["s"])("=");const t=yield Object(s["r"])([y(E),Object(s["k"])(Object(s["a"])(E))]).map(e=>e[0]).errorMap(l("Expected 0 or 1"));return{id:e,value:parseInt(t,10)}})),U=Object(s["e"])((function*(){yield Object(s["s"])("#");const e=yield s["f"].errorMap(l("Invalid time"));yield s["n"];var t=yield Object(s["o"])(_(O(y(H))));return t=t||[],yield Object(s["s"])(";"),{time:parseInt(e,10),assignments:t}})),X=Object(s["e"])((function*(){yield y(Object(s["s"])("test begin"));const e=yield Object(s["l"])(y(U));return yield y(Object(s["s"])("end")),e})),z=e=>{c=[];const t=Object(s["r"])([Object(s["m"])(y(Q)),s["h"]]).map(e=>e[0]).run(e);return{parseState:t,lint:c}};t["a"]=z},eb33:function(e,t,n){"use strict";var s=n("a12c"),r=n.n(s);r.a}}]);